# è§†å›¾ç²¾ç®€ä¸å‘¨è§†å›¾ç”˜ç‰¹å›¾åŒ– - å˜æ›´æŠ¥å‘Š

> æ—¥æœŸï¼š2026-02-07
> çŠ¶æ€ï¼šå·²å®Œæˆ

## æ¦‚è¿°

æœ¬æ¬¡å˜æ›´å¯¹æ’ä»¶çš„è§†å›¾ç³»ç»Ÿè¿›è¡Œäº†ç²¾ç®€å’Œé‡æ„ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹æ”¹åŠ¨ï¼š

1. **ç§»é™¤æ—¥è§†å›¾** â€” åˆ é™¤ `DayView` åŠæ‰€æœ‰ç›¸å…³å¼•ç”¨
2. **å‘¨è§†å›¾ç”˜ç‰¹å›¾åŒ–** â€” é‡å†™å‘¨è§†å›¾ä¸ºç”˜ç‰¹å›¾é£æ ¼ï¼ˆæ¨ªå‘æ—¶é—´æ¡ï¼‰
3. **æœˆè§†å›¾è¿‡æ»¤é€»è¾‘è°ƒæ•´** â€” å¾…åŠä»…åœ¨æˆªæ­¢æ—¥å½“å¤©æ˜¾ç¤º
4. **ä»»åŠ¡è§†å›¾ç²¾ç®€** â€” ä»…æ˜¾ç¤ºæˆªæ­¢æ—¶é—´ï¼Œç§»é™¤ä»»åŠ¡ç±»å‹æ ‡ç­¾

---

## ä¸€ã€ç§»é™¤æ—¥è§†å›¾

### åˆ é™¤çš„æ–‡ä»¶
- `src/views/DayView.ts` â€” æ—¥è§†å›¾æ¸²æŸ“å™¨
- `src/settings/builders/DayViewSettingsBuilder.ts` â€” æ—¥è§†å›¾è®¾ç½®æ„å»ºå™¨
- `src/components/TaskCard/presets/DayView.config.ts` çš„å¯¼å‡ºï¼ˆæ–‡ä»¶ä¿ç•™ä½†ä¸å†è¢«å¼•ç”¨ï¼‰

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|---------|
| `src/types.ts` | `CalendarViewType` ç§»é™¤ `'day'`ï¼Œæ”¹ä¸º `'month' \| 'week' \| 'task'` |
| `src/GCMainView.ts` | ç§»é™¤ `dayRenderer` åŠæ‰€æœ‰ DayView å¼•ç”¨ |
| `src/toolbar/toolbar-left.ts` | ä» `VIEW_BUTTONS` ç§»é™¤ day æŒ‰é’® |
| `src/toolbar/toolbar.ts` | ç§»é™¤ `DayViewRenderer` ç±»å‹å¯¼å…¥å’Œå‚æ•° |
| `src/toolbar/toolbar-right-calendar.ts` | ç§»é™¤ `DayViewRenderer` å¼•ç”¨å’Œ day æ¡ä»¶åˆ†æ”¯ |
| `src/settings/types.ts` | ç§»é™¤ `dayViewSortField`ã€`dayViewSortOrder` ç­‰å­—æ®µ |
| `src/settings/constants.ts` | ç§»é™¤ DayView é»˜è®¤è®¾ç½® |
| `src/settings/SettingTab.ts` | ç§»é™¤ `DayViewSettingsBuilder` å¯¼å…¥å’Œä½¿ç”¨ |
| `src/settings/builders/index.ts` | ç§»é™¤ DayView å¯¼å‡º |
| `src/settings/index.ts` | ç§»é™¤ DayView å¯¼å‡º |
| `src/components/TaskCard/index.ts` | ç§»é™¤ `DayViewConfig` å¯¼å‡º |
| `styles.css` | ç§»é™¤ `.gc-day-view` ç›¸å…³æ ·å¼ï¼ˆå¸ƒå±€ã€å­ç»„ä»¶ã€çŠ¶æ€æ ·å¼ï¼‰ |

### è¡Œä¸ºå˜æ›´
- `selectDate()` ç°åœ¨åˆ‡æ¢åˆ°å‘¨è§†å›¾ï¼ˆåŸæ¥åˆ‡æ¢åˆ°æ—¥è§†å›¾ï¼‰
- é»˜è®¤è§†å›¾é€‰é¡¹ä» `day | week | month | task` ç¼©å‡ä¸º `week | month | task`
- è®¾ç½®é¢æ¿ä¸­ä¸å†æ˜¾ç¤ºæ—¥è§†å›¾ç›¸å…³é…ç½®

---

## äºŒã€å‘¨è§†å›¾ç”˜ç‰¹å›¾åŒ–

### å¸ƒå±€ç»“æ„

```
Header Row:  [å‘¨ä¸€ 2] [å‘¨äºŒ 3] [å‘¨ä¸‰ 4] [å‘¨å›› 5] [å‘¨äº” 6] [å‘¨å…­ 7] [å‘¨æ—¥ 8]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Task Row 1:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®ŒæˆæŠ¥å‘Š â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Task Row 2:              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å›å¤é‚®ä»¶ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Reminder:    ğŸ”” æé†’1 â–ˆâ–ˆâ–ˆâ–ˆ    ğŸ”” æé†’3 â–ˆâ–ˆâ–ˆâ–ˆ
```

### æ ¸å¿ƒå®ç°

**æ–°å¢/é‡å†™æ–¹æ³•ï¼ˆ`src/views/WeekView.ts`ï¼‰ï¼š**

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `render()` | é‡å†™ï¼Œæ¸²æŸ“ç”˜ç‰¹å›¾é£æ ¼å¸ƒå±€ |
| `renderHeader()` | æ¸²æŸ“ 7 åˆ—æ—¥æœŸå¤´ |
| `renderGanttBody()` | æ¸²æŸ“ç”˜ç‰¹å›¾ä¸»ä½“ï¼Œåˆ†ç¦»å¾…åŠå’Œæé†’ |
| `renderGridLines()` | æ¸²æŸ“èƒŒæ™¯ç«–çº¿ç½‘æ ¼ |
| `collectWeekTasks()` | æ”¶é›†æ‰€æœ‰ä¸æœ¬å‘¨æœ‰äº¤é›†çš„ä»»åŠ¡ï¼ˆæ›¿ä»£åŸæ¥æŒ‰å¤©è¿‡æ»¤ï¼‰ |
| `renderGanttRow()` | æ¸²æŸ“ä¸€è¡Œï¼ˆå¯å«å¤šä¸ª barï¼‰ |
| `renderGanttBar()` | æ¸²æŸ“å•ä¸ªä»»åŠ¡ barï¼ˆä½ç½®ã€é¢œè‰²ã€äº¤äº’ï¼‰ |
| `calculateBarPosition()` | è®¡ç®— bar çš„ left/width ç™¾åˆ†æ¯”å®šä½ |
| `packRemindersIntoRows()` | è´ªå¿ƒè£…ç®±ç®—æ³•ï¼šå°†ä¸é‡å çš„æé†’åˆå¹¶åˆ°å…±äº«è¡Œ |

**BEM ç±»åæ–°å¢ï¼ˆ`src/utils/bem.ts`ï¼‰ï¼š**

| ç±»å | ç”¨é€” |
|------|------|
| `gc-week-view__gantt-body` | ç”˜ç‰¹å›¾ä¸»ä½“å®¹å™¨ |
| `gc-week-view__gantt-row` | ä»»åŠ¡è¡Œ |
| `gc-week-view__gantt-bar` | ä»»åŠ¡æ¡ |
| `gc-week-view__gantt-bar-label` | æ¡å†…æ ‡é¢˜æ–‡å­— |
| `gc-week-view__gantt-bar-icon` | æ¡å†…å›¾æ ‡ |
| `gc-week-view__gantt-grid-lines` | èƒŒæ™¯ç½‘æ ¼çº¿å®¹å™¨ |
| `gc-week-view__gantt-grid-line` | å•æ¡ç½‘æ ¼çº¿ |
| `gc-week-view__gantt-bar--high` | é«˜ä¼˜å…ˆçº§ä¿®é¥° |
| `gc-week-view__gantt-bar--normal` | æ™®é€šä¼˜å…ˆçº§ä¿®é¥° |
| `gc-week-view__gantt-bar--low` | ä½ä¼˜å…ˆçº§ä¿®é¥° |
| `gc-week-view__gantt-bar--reminder` | æé†’ç±»å‹ä¿®é¥° |
| `gc-week-view__gantt-bar--completed` | å·²å®Œæˆä¿®é¥° |
| `gc-week-view__gantt-grid-line--today` | ä»Šå¤©åˆ—é«˜äº® |

**CSS æ ·å¼æ–°å¢ï¼ˆ`styles.css`ï¼‰ï¼š**
- `.gc-week-view__gantt-body` â€” å¼¹æ€§å¸ƒå±€ï¼Œå¯æ»šåŠ¨
- `.gc-week-view__gantt-grid-lines` â€” 7 åˆ—ç½‘æ ¼çº¿ï¼ˆabsolute å®šä½ï¼‰
- `.gc-week-view__gantt-row` â€” 34px é«˜ï¼Œç›¸å¯¹å®šä½
- `.gc-week-view__gantt-bar` â€” absolute å®šä½ï¼Œç™¾åˆ†æ¯” left/width
- 5 ç§ä¼˜å…ˆçº§/ç±»å‹é¢œè‰²ï¼šé«˜=çº¢ã€æ™®é€š=è“ã€ä½=ç°ã€æé†’=æ©™è‰²è™šçº¿ã€å®Œæˆ=ç»¿

### æé†’åˆå¹¶é€»è¾‘

ä½¿ç”¨è´ªå¿ƒè£…ç®±ç®—æ³•ï¼ˆ`packRemindersIntoRows`ï¼‰ï¼Œå°†ä¸åœ¨åŒä¸€å¤©çš„æé†’æ”¾åˆ°åŒä¸€è¡Œï¼š
- è®¡ç®—æ¯ä¸ªæé†’çš„å¤©ç´¢å¼•ï¼ˆ0-6ï¼‰
- éå†æé†’ï¼Œå°è¯•æ”¾å…¥å·²æœ‰è¡Œï¼ˆè‹¥å¤©ç´¢å¼•ä¸å†²çªï¼‰
- å†²çªæ—¶æ–°å»ºè¡Œ

### äº¤äº’åŠŸèƒ½
- **Tooltip**ï¼šhover æ˜¾ç¤º `TooltipManager` æ‚¬æµ®æç¤º
- **ç‚¹å‡»ç¼–è¾‘**ï¼šè°ƒç”¨ `openEditTaskModal()` æ‰“å¼€ç¼–è¾‘å¼¹çª—
- **ç­›é€‰**ï¼šä¿ç•™çŠ¶æ€ç­›é€‰å’Œæ ‡ç­¾ç­›é€‰åŠŸèƒ½
- **æ’åº**ï¼šä¿ç•™æ’åºåŠŸèƒ½ï¼ˆé»˜è®¤æŒ‰ä¼˜å…ˆçº§é™åºï¼‰

---

## ä¸‰ã€æœˆè§†å›¾è¿‡æ»¤é€»è¾‘è°ƒæ•´

### ä¿®æ”¹ä½ç½®
`src/views/BaseViewRenderer.ts` çš„ `filterTasksForDate()` æ–¹æ³•

### å˜æ›´å‰
å¾…åŠä» `startDate` åˆ° `dueDate`ï¼ˆå«è¿‡æœŸå»¶ç»­åˆ°ä»Šå¤©ï¼‰èŒƒå›´å†…æ¯å¤©éƒ½æ˜¾ç¤ºã€‚

### å˜æ›´å
- **å¾…åŠ**ï¼šä»…åœ¨ `dueDate` å½“å¤©æ˜¾ç¤º
- **æ— æˆªæ­¢æ—¥çš„å¾…åŠ**ï¼šåœ¨ `startDate` å½“å¤©æ˜¾ç¤º
- **æé†’**ï¼šä»…åœ¨ `dueDate` å½“å¤©æ˜¾ç¤ºï¼ˆæœªå˜ï¼‰
- **å·²å®Œæˆä»»åŠ¡**ï¼šä»…åœ¨å®Œæˆæ—¥å½“å¤©æ˜¾ç¤ºï¼ˆæœªå˜ï¼‰

### å½±å“èŒƒå›´
- ä»…å½±å“æœˆè§†å›¾ï¼ˆ`MonthView`ï¼‰
- å‘¨è§†å›¾æœ‰ç‹¬ç«‹çš„ `collectWeekTasks()` æ–¹æ³•ï¼Œä¸å—å½±å“
- ä»»åŠ¡è§†å›¾æœ‰ç‹¬ç«‹è¿‡æ»¤é€»è¾‘ï¼Œä¸å—å½±å“

---

## å››ã€ä»»åŠ¡è§†å›¾ç²¾ç®€

### ä¿®æ”¹ä½ç½®
`src/components/TaskCard/presets/TaskView.config.ts`

### å˜æ›´å†…å®¹
1. **æ—¶é—´å±æ€§**ï¼šä»…ä¿ç•™æˆªæ­¢æ—¶é—´æ˜¾ç¤º
   - `showCreated: false`ï¼ˆåŸ `true`ï¼‰
   - `showStart: false`ï¼ˆåŸ `true`ï¼‰
   - `showScheduled: false`ï¼ˆåŸ `true`ï¼‰
   - `showDue: true`ï¼ˆä¿æŒï¼‰
   - `showCancelled: false`ï¼ˆåŸ `true`ï¼‰
   - `showCompletion: false`ï¼ˆåŸ `true`ï¼‰

2. **ä»»åŠ¡ç±»å‹æ ‡ç­¾**ï¼šä¸å†æ˜¾ç¤º
   - `showFileLocation: false`ï¼ˆåŸ `true`ï¼Œæ­¤å­—æ®µå®é™…æ¸²æŸ“çš„æ˜¯"å¾…åŠ"/"æé†’"æ–‡å­—ï¼‰

---

## äº”ã€æ–‡æ¡£æ›´æ–°

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|---------|
| `CLAUDE.md` | æ›´æ–°è§†å›¾ç³»ç»Ÿæè¿°ï¼Œç§»é™¤ DayView/YearView/GanttView å¼•ç”¨ |
| `AGENTS.md` | åŒæ­¥ CLAUDE.md çš„è§†å›¾ç³»ç»Ÿæè¿°å˜æ›´ |

---

## æ„å»ºéªŒè¯

æ‰€æœ‰ä¿®æ”¹å‡é€šè¿‡ `tsc -noEmit -skipLibCheck` å’Œ `npm run build` éªŒè¯ï¼Œæ— ç±»å‹é”™è¯¯ã€‚
