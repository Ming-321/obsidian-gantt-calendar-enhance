# ä»»åŠ¡ç³»ç»Ÿé‡æ–°è®¾è®¡æ–¹æ¡ˆ

> æ—¥æœŸï¼š2026-02-06
> çŠ¶æ€ï¼šå·²ç¡®è®¤

## æ¦‚è¿°

å¯¹ Obsidian Gantt Calendar æ’ä»¶è¿›è¡Œä¸‰é¡¹æ ¸å¿ƒæ”¹é€ ï¼š

1. **ç‹¬ç«‹ä»»åŠ¡å­˜å‚¨** â€” ä¸å†è§£æ Markdown ä¸­çš„ Tasks/Dataview æ ¼å¼ï¼Œæ”¹ç”¨ä¸“ç”¨ JSON æ–‡ä»¶å­˜å‚¨
2. **ä»»åŠ¡ç±»å‹ç»†åˆ†** â€” å°†ä»»åŠ¡åˆ†ä¸ºã€Œå¾…åŠã€å’Œã€Œæé†’ã€ä¸¤ç§ç±»å‹ï¼Œè¡Œä¸ºå’Œç”Ÿå‘½å‘¨æœŸä¸åŒ
3. **GitHub Action é‚®ä»¶æé†’** â€” å®šæ—¶è¯»å–ä»»åŠ¡æ•°æ®ï¼Œå‘æŒ‡å®šé‚®ç®±å‘é€æœªå®Œæˆäº‹é¡¹æé†’

---

## ä¸€ã€æ•°æ®æ¨¡å‹

### æ ¸å¿ƒæ¥å£

```typescript
interface BaseTask {
  id: string;                    // UUIDï¼Œå”¯ä¸€æ ‡è¯†
  type: 'todo' | 'reminder';    // ä»»åŠ¡ç±»å‹ï¼šå¾…åŠ | æé†’
  title: string;                 // æ ‡é¢˜
  description?: string;          // è¯¦ç»†æè¿°ï¼ˆå¯é€‰ï¼‰

  // æ—¥æœŸç³»ç»Ÿ
  createdDate: string;           // åˆ›å»ºæ—¥æœŸ (ISO 8601)
  dueDate: string;               // æˆªæ­¢/æé†’æ—¥æœŸ (ISO 8601)
  startDate?: string;            // å¼€å§‹æ—¥æœŸï¼ˆé»˜è®¤ä¸ºåˆ›å»ºæ—¶é—´ï¼‰
  time?: string;                 // å¯é€‰çš„ç²¾ç¡®æ—¶é—´ "HH:mm"

  // å±æ€§
  priority: 'high' | 'normal' | 'low';  // ä¸‰çº§ä¼˜å…ˆçº§
  tags?: string[];               // æ ‡ç­¾
  repeat?: string;               // é‡å¤è§„åˆ™ "every day" / "every monday"

  // çŠ¶æ€
  completed: boolean;
  completionDate?: string;
  cancelled?: boolean;
  cancelledDate?: string;
  archived: boolean;             // å½’æ¡£æ ‡è®°

  // å…ƒæ•°æ®
  lastModified: string;          // æœ€åä¿®æ”¹æ—¶é—´ (ISO 8601)
}

// å¾…åŠ â€” æˆªæ­¢æ—¥å‰æŒç»­æ˜¾ç¤ºï¼Œæ‰‹åŠ¨å®Œæˆï¼Œå¯å»¶æœŸ
interface TodoTask extends BaseTask {
  type: 'todo';
}

// æé†’ â€” ä»…åœ¨æŒ‡å®šæ—¥æœŸæ˜¾ç¤ºï¼Œåˆ°æœŸè‡ªåŠ¨å®Œæˆå¹¶å½’æ¡£
interface ReminderTask extends BaseTask {
  type: 'reminder';
}
```

### JSON å­˜å‚¨æ ¼å¼

æ–‡ä»¶ä½ç½®ï¼š`.obsidian/plugins/obsidian-gantt-calendar/data/tasks.json`

```json
{
  "version": 1,
  "tasks": [
    {
      "id": "uuid-1",
      "type": "todo",
      "title": "å®Œæˆé¡¹ç›®æŠ¥å‘Š",
      "createdDate": "2026-02-01T00:00:00Z",
      "dueDate": "2026-02-10T00:00:00Z",
      "startDate": "2026-02-01T00:00:00Z",
      "priority": "high",
      "tags": ["å·¥ä½œ"],
      "completed": false,
      "archived": false,
      "lastModified": "2026-02-01T10:00:00Z"
    },
    {
      "id": "uuid-2",
      "type": "reminder",
      "title": "æ•°å­¦è¯¾è€ƒè¯•",
      "createdDate": "2026-01-20T00:00:00Z",
      "dueDate": "2026-02-06T00:00:00Z",
      "time": "14:00",
      "priority": "normal",
      "completed": false,
      "archived": false,
      "lastModified": "2026-01-20T10:00:00Z"
    }
  ],
  "archive": [],
  "lastSync": "2026-02-06T10:00:00Z"
}
```

è®¾è®¡è¦ç‚¹ï¼š
- `version` å­—æ®µæ”¯æŒæœªæ¥çš„æ•°æ®ç»“æ„è¿ç§»
- `archive` æ•°ç»„å•ç‹¬å­˜æ”¾å½’æ¡£çš„æé†’å’Œå·²å®Œæˆä»»åŠ¡
- `lastSync` è®°å½•æœ€ååŒæ­¥æ—¶é—´ï¼Œæ–¹ä¾¿ GitHub Action ä½¿ç”¨
- ä¸éœ€è¦è¿ç§»æ—§æ•°æ®ï¼Œå…¨æ–°å¼€å§‹

---

## äºŒã€å­˜å‚¨æ¶æ„

### æ¶æ„å˜æ›´

```
æ—§æ¶æ„:  TaskStore â†’ TaskRepository â†’ MarkdownDataSource â†’ è§£æ Markdown æ–‡ä»¶
æ–°æ¶æ„:  TaskStore â†’ TaskRepository â†’ JsonDataSource    â†’ tasks.json æ–‡ä»¶
```

### æ ¸å¿ƒæ”¹é€ 

1. **æ–°å»º `JsonDataSource`**ï¼ˆæ›¿ä»£ `MarkdownDataSource`ï¼‰
   - `load()`: è¯»å– tasks.jsonï¼Œè§£æä¸º GCTask æ•°ç»„
   - `save()`: å°†å†…å­˜ä¸­çš„ä»»åŠ¡åºåˆ—åŒ–å†™å…¥ tasks.json
   - `create(task)`: æ·»åŠ æ–°ä»»åŠ¡
   - `update(task)`: æ›´æ–°å·²æœ‰ä»»åŠ¡
   - `delete(id)`: åˆ é™¤ä»»åŠ¡
   - `archive(id)`: å½’æ¡£ä»»åŠ¡

2. **ä¿æŒä¸Šå±‚ä¸å˜**
   - `TaskStore`ï¼ˆé—¨é¢ï¼‰API ä¸å˜
   - `TaskRepository`ï¼ˆä»“åº“ï¼‰æ¥å£ä¸å˜
   - `EventBus` äº‹ä»¶ç³»ç»Ÿä¸å˜
   - è§†å›¾è®¢é˜…æœºåˆ¶ä¸å˜

3. **ç§»é™¤ Markdown ç›¸å…³ä»£ç **
   - ç§»é™¤ `MarkdownDataSource`
   - ç§»é™¤ `taskParser`ï¼ˆå››æ­¥è§£ææµæ°´çº¿ï¼‰
   - ç§»é™¤ Tasks/Dataview æ ¼å¼ç›¸å…³æ­£åˆ™
   - ç§»é™¤ `GCTask` ä¸­çš„ `filePath`ã€`lineNumber`ã€`format` å­—æ®µ

### è‡ªåŠ¨å½’æ¡£æœºåˆ¶

æ’ä»¶åœ¨ä»¥ä¸‹æ—¶æœºæ£€æŸ¥å¹¶è‡ªåŠ¨å½’æ¡£è¿‡æœŸæé†’ï¼š
- æ’ä»¶åŠ è½½æ—¶
- æ¯å¤©å®šæ—¶æ£€æŸ¥ï¼ˆå¯é…ç½®æ—¶é—´ç‚¹ï¼‰
- è§†å›¾åˆ‡æ¢æ—¶

å½’æ¡£é€»è¾‘ï¼š
```typescript
function autoArchiveReminders(tasks: BaseTask[]): void {
  const today = new Date();
  today.setHours(0, 0, 0, 0);

  for (const task of tasks) {
    if (task.type === 'reminder' && !task.archived) {
      const dueDate = new Date(task.dueDate);
      dueDate.setHours(0, 0, 0, 0);
      if (dueDate < today) {
        task.completed = true;
        task.completionDate = task.dueDate;
        task.archived = true;
      }
    }
  }
}
```

---

## ä¸‰ã€ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸ

### å¾…åŠï¼ˆTodoï¼‰

```
åˆ›å»º â†’ æ´»è·ƒçŠ¶æ€ï¼ˆstartDate åˆ° dueDate æŒç»­æ˜¾ç¤ºï¼‰
     â†’ åˆ°æœŸæœªå®Œæˆï¼šç»§ç»­æ˜¾ç¤ºï¼ˆæ ‡çº¢/åŠ é€¾æœŸæ ‡è®°ï¼‰
     â†’ æ‰‹åŠ¨å®Œæˆï¼šæ ‡è®° completedï¼Œå¯é€‰å½’æ¡£
     â†’ å»¶æœŸï¼šä¿®æ”¹ dueDate
     â†’ å–æ¶ˆï¼šæ ‡è®° cancelled
```

### æé†’ï¼ˆReminderï¼‰

```
åˆ›å»º â†’ ç­‰å¾…ä¸­ï¼ˆdueDate å‰ä¸åœ¨æ—¥å†ä¸­æ˜¾ç¤ºï¼‰
     â†’ dueDate å½“å¤©ï¼šæ˜¾ç¤ºåœ¨æ—¥å†ä¸­
     â†’ dueDate è¿‡åï¼šè‡ªåŠ¨æ ‡è®° completed + archived
     â†’ ç§»å…¥ archive æ•°ç»„
```

### è¡Œä¸ºå·®å¼‚å¯¹æ¯”

| è¡Œä¸º       | å¾…åŠ (Todo)             | æé†’ (Reminder)        |
|-----------|------------------------|------------------------|
| æ˜¾ç¤ºæ—¶é—´   | startDate åˆ°å®Œæˆ        | ä»… dueDate å½“å¤©         |
| è¿‡æœŸè¡Œä¸º   | ç»§ç»­æ˜¾ç¤ºï¼ˆæ ‡çº¢ï¼‰         | è‡ªåŠ¨å®Œæˆå¹¶å½’æ¡£           |
| å®Œæˆæ–¹å¼   | æ‰‹åŠ¨å‹¾é€‰                | åˆ°æœŸè‡ªåŠ¨å®Œæˆ             |
| å¯å»¶æœŸ     | æ˜¯                     | å¦                      |
| å¤é€‰æ¡†     | æœ‰                     | æ—                       |
| é‡å¤       | æ”¯æŒ                   | æ”¯æŒ                    |

---

## å››ã€ä»»åŠ¡è¾“å…¥ UI

### æ–¹å¼ä¸€ï¼šæ—¥å†å¿«é€Ÿæ·»åŠ 

åœ¨æœˆ/å‘¨/æ—¥è§†å›¾ä¸­ï¼Œç‚¹å‡»æŸä¸€å¤©çš„ç©ºç™½åŒºåŸŸå¼¹å‡ºè½»é‡çº§è¾“å…¥æ ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â—‹å¾…åŠ  â—‹æé†’  â”‚ [è¾“å…¥æ ‡é¢˜...]  [+] â”‚
â”‚               â”‚ 2æœˆ6æ—¥    â–¾ä¼˜å…ˆçº§   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

é»˜è®¤å€¼ï¼š
- æ—¥æœŸ = ç‚¹å‡»çš„é‚£ä¸€å¤©
- ç±»å‹ = å¾…åŠ
- ä¼˜å…ˆçº§ = normal
- å¼€å§‹æ—¥æœŸ = å½“å‰æ—¥æœŸ

æ“ä½œï¼š
- æŒ‰å›è½¦æˆ–ç‚¹ `[+]` ç«‹å³åˆ›å»º
- ç‚¹å‡»å±•å¼€æŒ‰é’®è¿›å…¥è¯¦ç»†è¡¨å•

### æ–¹å¼äºŒï¼šè¯¦ç»†è¡¨å•å¼¹çª—

è§¦å‘æ–¹å¼ï¼š
- å¿«é€Ÿæ·»åŠ æ çš„å±•å¼€æŒ‰é’®
- å·¥å…·æ ä¸Šçš„ã€Œæ–°å»ºä»»åŠ¡ã€æŒ‰é’®
- Obsidian å‘½ä»¤é¢æ¿ï¼ˆ`Ctrl+P` â†’ "åˆ›å»ºä»»åŠ¡"ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ–°å»ºä»»åŠ¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    â”‚
â”‚  ç±»å‹:  [â— å¾…åŠ]  [â—‹ æé†’]        â”‚
â”‚                                    â”‚
â”‚  æ ‡é¢˜:  [________________________] â”‚
â”‚  æè¿°:  [________________________] â”‚
â”‚         [________________________] â”‚
â”‚                                    â”‚
â”‚  æˆªæ­¢æ—¥æœŸ:  [2026-02-10]  ğŸ“…      â”‚
â”‚  å¼€å§‹æ—¥æœŸ:  [2026-02-06]  ğŸ“…      â”‚  â† é»˜è®¤å½“å‰æ—¥æœŸ
â”‚  æ—¶é—´:      [å¯é€‰ HH:mm]  ğŸ•     â”‚
â”‚                                    â”‚
â”‚  ä¼˜å…ˆçº§:  [ä½] [â— æ™®é€š] [é«˜]      â”‚
â”‚  æ ‡ç­¾:    [+æ·»åŠ æ ‡ç­¾]              â”‚
â”‚  é‡å¤:    [ä¸é‡å¤ â–¾]              â”‚
â”‚                                    â”‚
â”‚         [å–æ¶ˆ]      [åˆ›å»º]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä»»åŠ¡æ“ä½œ

- **ç¼–è¾‘**ï¼šç‚¹å‡»å·²æœ‰ä»»åŠ¡æ¡ç›®æ‰“å¼€åŒæ ·çš„è¡¨å•å¼¹çª—ï¼ˆé¢„å¡«æ•°æ®ï¼‰
- **åˆ é™¤**ï¼šå³é”®èœå•æˆ–å¼¹çª—ä¸­çš„åˆ é™¤æŒ‰é’®
- **å®Œæˆ**ï¼šç‚¹å‡»å¤é€‰æ¡†ï¼ˆä»…å¾…åŠï¼‰
- **å»¶æœŸ**ï¼šå¾…åŠå³é”®èœå• â†’ å»¶æœŸä¸€å¤© / é€‰æ‹©æ–°æ—¥æœŸ

---

## äº”ã€è§†å›¾å±‚é€‚é…

### æ•°æ®æºåˆ‡æ¢

ç”±äº `TaskStore` API ä¿æŒä¸å˜ï¼Œè§†å›¾å±‚æ”¹åŠ¨æœ€å°åŒ–ï¼š

1. **`GCTask` æ¥å£æ›´æ–°**ï¼š
   - æ–°å¢ï¼š`type`ã€`archived`ã€`time` å­—æ®µ
   - ç§»é™¤ï¼š`filePath`ã€`lineNumber`ã€`format`ã€`content`ï¼ˆMarkdown ç›¸å…³ï¼‰
   - ä¿ç•™ï¼šæ‰€æœ‰æ˜¾ç¤ºç›¸å…³å­—æ®µ

2. **è¿‡æ»¤é€»è¾‘è°ƒæ•´**ï¼š
   - é»˜è®¤ä¸æ˜¾ç¤ºå·²å½’æ¡£ä»»åŠ¡
   - æé†’ä»…åœ¨ dueDate å½“å¤©å‡ºç°
   - å¾…åŠä» startDate åˆ°å®Œæˆä¸€ç›´æ˜¾ç¤º

### è§†è§‰åŒºåˆ†

æ—¥å†ä¸­å¾…åŠå’Œæé†’ä½¿ç”¨ä¸åŒæ ·å¼ï¼š

```
â”Œâ”€â”€â”€ 2æœˆ6æ—¥ï¼ˆå‘¨å››ï¼‰â”€â”€â”€â”
â”‚ â˜ å®Œæˆé¡¹ç›®æŠ¥å‘Š    ğŸ”´ â”‚  â† å¾…åŠï¼Œçº¢è‰²=é«˜ä¼˜å…ˆçº§
â”‚ â˜ å›å¤é‚®ä»¶        âšª â”‚  â† å¾…åŠï¼Œæ™®é€šä¼˜å…ˆçº§
â”‚ ğŸ”” æ•°å­¦è¯¾è€ƒè¯•      â”‚  â† æé†’ï¼Œé“ƒé“›å›¾æ ‡ï¼Œä¸åŒèƒŒæ™¯è‰²
â”‚ ğŸ”” å°æ˜ç”Ÿæ—¥        â”‚  â† æé†’ï¼Œé“ƒé“›å›¾æ ‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **å¾…åŠ**ï¼šå¸¦å¤é€‰æ¡† `â˜`ï¼Œä¼˜å…ˆçº§ç”¨é¢œè‰²æ ‡è®°
- **æé†’**ï¼šé“ƒé“›å›¾æ ‡ `ğŸ””`ï¼Œæ— å¤é€‰æ¡†ï¼Œä½¿ç”¨åŒºåˆ«äºå¾…åŠçš„èƒŒæ™¯è‰²ï¼ˆæµ…è“è‰²è°ƒï¼‰

### ç”˜ç‰¹å›¾é€‚é…

- å¾…åŠï¼šæ˜¾ç¤ºä¸ºæ—¶é—´æ®µæ¡ï¼ˆstartDate â†’ dueDateï¼‰
- æé†’ï¼šæ˜¾ç¤ºä¸ºæ—¶é—´ç‚¹æ ‡è®°ï¼ˆä»… dueDate å½“å¤©çš„ä¸€ä¸ªç‚¹/çŸ­æ ‡è®°ï¼‰

### ä»»åŠ¡è§†å›¾ç­›é€‰

```
[å…¨éƒ¨] [å¾…åŠ] [æé†’] [å·²å½’æ¡£]    æ’åº: [æˆªæ­¢æ—¥æœŸ â–¾]
```

---

## å…­ã€GitHub Action é‚®ä»¶æé†’

### æ•´ä½“æ¶æ„

é‡‡ç”¨**ç‹¬ç«‹ GitHub æ•°æ®ä»“åº“**æ–¹æ¡ˆï¼Œä»»åŠ¡æ•°æ®ä¸ Vault åŒæ­¥å®Œå…¨è§£è€¦ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Obsidian æ’ä»¶                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æœ¬åœ°å­˜å‚¨  â”‚â”€â”€â”€â†’â”‚ JsonDataSourceâ”‚â”€â”€â”€â†’â”‚ GitHub API æ¨é€ â”‚ â”‚
â”‚  â”‚tasks.jsonâ”‚    â”‚  è¯»/å†™/å½’æ¡£   â”‚    â”‚ (é˜²æŠ–è‡ªåŠ¨åŒæ­¥)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â†“
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  GitHub ä¸“ç”¨ç§æœ‰ä»“åº“     â”‚
                              â”‚  my-task-data/          â”‚
                              â”‚  â”œâ”€â”€ tasks.json         â”‚
                              â”‚  â”œâ”€â”€ scripts/           â”‚
                              â”‚  â”‚   â””â”€â”€ generate-email.js
                              â”‚  â””â”€â”€ .github/workflows/ â”‚
                              â”‚      â””â”€â”€ task-reminder.yml
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â†“
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  GitHub Action (å®šæ—¶)   â”‚
                              â”‚  è¯»å– tasks.json       â”‚
                              â”‚  ç”Ÿæˆé‚®ä»¶ â†’ å‘é€       â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### GitHub æ•°æ®æ¨é€

æ’ä»¶é€šè¿‡ GitHub Contents API ç›´æ¥æ¨é€ tasks.json åˆ°ä¸“ç”¨ä»“åº“ï¼š

- API: `PUT /repos/{owner}/{repo}/contents/tasks.json`
- **é˜²æŠ–æ¨é€**ï¼šä»»åŠ¡å˜æ›´åç­‰å¾… 30 ç§’å†æ¨é€ï¼Œé¿å…é¢‘ç¹è¯·æ±‚
- æ¨é€å‰è·å–æ–‡ä»¶ SHAï¼Œç¡®ä¿ä¸è¦†ç›–å†²çª
- ç¦»çº¿æ—¶æœ¬åœ°æ­£å¸¸å·¥ä½œï¼Œæ¢å¤ç½‘ç»œåè‡ªåŠ¨æ¨é€

```typescript
class GitHubSyncService {
  private debounceTimer: number | null = null;
  private readonly DEBOUNCE_MS = 30000;

  async push(tasks: TasksData): Promise<void> {
    // è·å–å½“å‰æ–‡ä»¶ SHA
    const currentFile = await this.getFile();
    const sha = currentFile?.sha;

    // æ¨é€æ›´æ–°
    await this.octokit.repos.createOrUpdateFileContents({
      owner: this.owner,
      repo: this.repo,
      path: 'tasks.json',
      message: `sync: update tasks ${new Date().toISOString()}`,
      content: btoa(JSON.stringify(tasks, null, 2)),
      sha: sha
    });
  }

  schedulePush(tasks: TasksData): void {
    if (this.debounceTimer) clearTimeout(this.debounceTimer);
    this.debounceTimer = window.setTimeout(() => this.push(tasks), this.DEBOUNCE_MS);
  }
}
```

### é¦–æ¬¡è®¾ç½®å‘å¯¼

æ’ä»¶æä¾›ä¸€é”®åˆå§‹åŒ–åŠŸèƒ½ï¼Œç”¨æˆ·åªéœ€å¡«å†™ Token å’Œä»“åº“åï¼Œæ’ä»¶è‡ªåŠ¨ï¼š
1. åˆ›å»ºä»“åº“ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
2. æ¨é€ tasks.json
3. æ¨é€ `scripts/generate-email.js`
4. æ¨é€ `.github/workflows/task-reminder.yml`
5. å¼•å¯¼ç”¨æˆ·é…ç½® GitHub Secretsï¼ˆEMAIL_TOã€SMTP ä¿¡æ¯ï¼‰

### Action å·¥ä½œæµé…ç½®

æ–‡ä»¶ä½ç½®ï¼ˆåœ¨ä¸“ç”¨æ•°æ®ä»“åº“ä¸­ï¼‰ï¼š`.github/workflows/task-reminder.yml`

```yaml
name: Task Email Reminder

on:
  schedule:
    # æ—©ä¸Š 7:00 (UTC+8 = å‰ä¸€å¤© UTC 23:00)
    - cron: '0 23 * * *'
    # ä¸­åˆ 12:00 (UTC+8 = UTC 4:00)
    - cron: '0 4 * * *'
    # æ™šä¸Š 20:00 (UTC+8 = UTC 12:00)
    - cron: '0 12 * * *'

jobs:
  send-reminder:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: npm install nodemailer
      - run: node scripts/generate-email.js
        env:
          EMAIL_TO: ${{ secrets.EMAIL_TO }}
          SMTP_HOST: ${{ secrets.SMTP_HOST }}
          SMTP_USER: ${{ secrets.SMTP_USER }}
          SMTP_PASS: ${{ secrets.SMTP_PASS }}
          SCHEDULE_TYPE: ${{ github.event.schedule }}
```

### é‚®ä»¶å†…å®¹å·®å¼‚åŒ–

#### æ—©æ™¨ï¼ˆ7:00ï¼‰â€” å…¨é¢æ—¥æŠ¥

```
ğŸ“‹ ä»Šæ—¥å¾…åŠäº‹é¡¹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”´ [é«˜] å®Œæˆé¡¹ç›®æŠ¥å‘Š (æˆªæ­¢: ä»Šå¤©)
âšª [æ™®é€š] å›å¤å®¢æˆ·é‚®ä»¶ (æˆªæ­¢: æ˜å¤©)
âšª [æ™®é€š] å‡†å¤‡å‘¨ä¼šææ–™ (æˆªæ­¢: 2æœˆ8æ—¥)

ğŸ”” è¿‘æœŸæé†’ï¼ˆä»Šå¤© + æœªæ¥3å¤©ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ ä»Šå¤© 2æœˆ6æ—¥:
  â€¢ 14:00 æ•°å­¦è¯¾è€ƒè¯•
  â€¢ å°æ˜ç”Ÿæ—¥
ğŸ“ æ˜å¤© 2æœˆ7æ—¥:
  â€¢ 10:00 éƒ¨é—¨ä¼šè®®
ğŸ“ 2æœˆ8æ—¥:
  â€¢ é¡¹ç›®è¯„å®¡

ğŸ“Š æ¦‚è§ˆ
â”â”â”â”â”â”
å¾…åŠæ€»æ•°: 5 | ä»Šæ—¥åˆ°æœŸ: 2 | å·²é€¾æœŸ: 1
```

#### ä¸­åˆï¼ˆ12:00ï¼‰& æ™šä¸Šï¼ˆ20:00ï¼‰â€” å½“å¤©èšç„¦

```
â° å¾…åŠæé†’
â”â”â”â”â”â”â”â”â”â”
ğŸ”´ å®Œæˆé¡¹ç›®æŠ¥å‘Š â€” ä»Šå¤©æˆªæ­¢ï¼

ğŸ”” ä»Šæ—¥æé†’
â”â”â”â”â”â”â”â”â”â”
â€¢ 14:00 æ•°å­¦è¯¾è€ƒè¯•
â€¢ å°æ˜ç”Ÿæ—¥

æœªå®Œæˆå¾…åŠæ•°: 2
```

### é‚®ä»¶è„šæœ¬

åœ¨é¡¹ç›®ä¸­æä¾› `scripts/generate-email.js`ï¼ŒåŠŸèƒ½ï¼š
1. è¯»å– tasks.json
2. æ ¹æ®å½“å‰æ—¶é—´å’Œ SCHEDULE_TYPE ç¡®å®šé‚®ä»¶ç±»å‹
3. è¿‡æ»¤å’Œæ’åºä»»åŠ¡
4. ç”Ÿæˆ HTML æ ¼å¼é‚®ä»¶
5. é€šè¿‡ nodemailer + SMTP å‘é€

### æ‰€éœ€é…ç½®

#### æ’ä»¶è®¾ç½®ï¼ˆå­˜å‚¨åœ¨ Obsidian æ’ä»¶é…ç½®ä¸­ï¼‰

| è®¾ç½®é¡¹          | è¯´æ˜                           |
|----------------|-------------------------------|
| `githubToken`   | GitHub Personal Access Token   |
| `githubRepo`    | æ•°æ®ä»“åº“åï¼ˆå¦‚ my-task-dataï¼‰  |
| `githubOwner`   | GitHub ç”¨æˆ·å                  |
| `syncEnabled`   | æ˜¯å¦å¯ç”¨ GitHub åŒæ­¥           |

#### GitHub Secretsï¼ˆé…ç½®åœ¨æ•°æ®ä»“åº“ä¸­ï¼‰

| Secret      | è¯´æ˜                          |
|------------|-------------------------------|
| `EMAIL_TO`  | æ¥æ”¶é‚®ç®±åœ°å€                   |
| `SMTP_HOST` | SMTP æœåŠ¡å™¨ï¼ˆå¦‚ smtp.qq.comï¼‰ |
| `SMTP_USER` | SMTP ç”¨æˆ·å                   |
| `SMTP_PASS` | SMTP å¯†ç /æˆæƒç               |

### æ’ä»¶ä¾§è®¾ç½®

åœ¨è®¾ç½®é¡µé¢ä¸­æ–°å¢ã€ŒGitHub åŒæ­¥ & é‚®ä»¶æé†’ã€åŒºåŸŸï¼š
- ä¸€é”®åˆå§‹åŒ–å‘å¯¼ï¼ˆåˆ›å»ºä»“åº“ + æ¨é€é…ç½®ï¼‰
- GitHub Token é…ç½®
- åŒæ­¥çŠ¶æ€æŒ‡ç¤ºï¼ˆä¸Šæ¬¡åŒæ­¥æ—¶é—´ã€çŠ¶æ€ï¼‰
- æ‰‹åŠ¨è§¦å‘åŒæ­¥æŒ‰é’®
- GitHub Secrets é…ç½®å¼•å¯¼é“¾æ¥

---

## ä¸ƒã€å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šæ•°æ®å±‚æ”¹é€ 
1. å®šä¹‰æ–°çš„ `GCTask` æ¥å£ï¼ˆå« typeã€archived ç­‰ï¼‰
2. å®ç° `JsonDataSource`ï¼ˆCRUD + è‡ªåŠ¨å½’æ¡£ï¼‰
3. ç§»é™¤ `MarkdownDataSource` å’Œ `taskParser`
4. æ›´æ–° `TaskRepository` å’Œ `TaskStore`

### ç¬¬äºŒé˜¶æ®µï¼šä»»åŠ¡è¾“å…¥
5. å®ç°è¯¦ç»†è¡¨å•å¼¹çª—ï¼ˆModalï¼‰
6. å®ç°æ—¥å†å¿«é€Ÿæ·»åŠ ç»„ä»¶
7. æ³¨å†Œ Obsidian å‘½ä»¤
8. å®ç°å³é”®èœå•ï¼ˆç¼–è¾‘ã€åˆ é™¤ã€å»¶æœŸï¼‰

### ç¬¬ä¸‰é˜¶æ®µï¼šè§†å›¾é€‚é…
9. æ›´æ–°å„è§†å›¾çš„ä»»åŠ¡æ¸²æŸ“é€»è¾‘ï¼ˆåŒºåˆ†å¾…åŠ/æé†’ï¼‰
10. æ›´æ–°ä»»åŠ¡ç­›é€‰åŠŸèƒ½
11. é€‚é…ç”˜ç‰¹å›¾
12. æ›´æ–°æ ·å¼ï¼ˆå¾…åŠ vs æé†’è§†è§‰åŒºåˆ†ï¼‰

### ç¬¬å››é˜¶æ®µï¼šGitHub åŒæ­¥
13. å®ç° `GitHubSyncService`ï¼ˆAPI æ¨é€ã€é˜²æŠ–ã€ç¦»çº¿å¤„ç†ï¼‰
14. å®ç°é¦–æ¬¡è®¾ç½®å‘å¯¼ï¼ˆä¸€é”®åˆå§‹åŒ–ä»“åº“ï¼‰
15. åœ¨è®¾ç½®é¡µé¢æ·»åŠ  GitHub åŒæ­¥é…ç½®åŒºåŸŸ

### ç¬¬äº”é˜¶æ®µï¼šGitHub Action é‚®ä»¶
16. ç¼–å†™ `scripts/generate-email.js`ï¼ˆé‚®ä»¶ç”Ÿæˆè„šæœ¬ï¼‰
17. ç¼–å†™ `.github/workflows/task-reminder.yml`ï¼ˆAction é…ç½®ï¼‰
18. ç¼–å†™ GitHub Secrets é…ç½®æ–‡æ¡£

### ç¬¬å…­é˜¶æ®µï¼šæ¸…ç†ä¸ä¼˜åŒ–
19. ç§»é™¤æœªä½¿ç”¨çš„ Markdown è§£æä»£ç 
20. æ›´æ–°è®¾ç½®é¡µé¢
21. æ›´æ–° BEM ç±»åå®šä¹‰
22. æµ‹è¯•å…¨æµç¨‹
