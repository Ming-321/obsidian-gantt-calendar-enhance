/*
========================================
Gantt Calendar Plugin Styles - 甘特日历
Architecture: ITCSS (Inverted Triangle CSS)
Last Updated: 2025-12-26
Author: sugar
========================================
*/

/* ========================================
   LAYER 1: Settings (配置层)
   CSS Variables & Custom Properties
   ======================================== */

:root {
	/* Festival Colors */
	--festival-solar-color: #e74c3c;    /* 阳历节日 - 红色 */
	--festival-lunar-color: #e8a041;    /* 农历节日 - 橙色 */
	--festival-solar-term-color: #52c41a; /* 节气 - 绿色 */

	/* ===== Priority Colors (v4 配色：橙→蓝→灰 递减梯度) ===== */
	--gc-priority-high: #d97757;        /* 赤陶橙 - 暖色=紧迫 */
	--gc-priority-normal: #6BB3E0;      /* 清澈蓝 - 清晰=平稳 */
	--gc-priority-low: #8b949e;         /* 灰色 - 灰暗=不重要 */

	/* ===== NEW: Status Colors ===== */
	--gc-status-completed: #3fb950;     /* 翠绿 - 已完成 */
	--gc-status-canceled: #8b949e;      /* 中性灰 - 已取消 */
	--gc-status-overdue: #e5534b;       /* 警示红 - 过期 */

	/* ===== NEW: Today Highlight ===== */
	--gc-today-bg: rgba(255, 107, 107, 0.08);

	/* ===== NEW: Opacity ===== */
	--gc-completed-opacity: 0.5;
	--gc-canceled-opacity: 0.4;
	--gc-parent-fill-opacity: 0.12;

	/* ===== NEW: Spacing ===== */
	--gc-card-gap: 4px;
	--gc-card-padding: 6px 8px;
	--gc-month-cell-padding: 2px 3px;
	--gc-month-task-gap: 1px;
	--gc-gantt-row-height: 27px;

	/* ===== NEW: Color Band Width ===== */
	--gc-band-width-default: 3px;
	--gc-band-width-child: 2px;

	/* ===== NEW: Status Icon Size ===== */
	--gc-icon-size-compact: 14px;       /* 月视图、周视图 */
	--gc-icon-size-normal: 16px;        /* 任务视图 */
}

/* Dark theme override */
.theme-dark {
	--gc-priority-low: #9aafbf;         /* 暗色主题下灰色调亮以保证对比度 */
}


/* ========================================
   LAYER 2: Tools (工具层)
   Not applicable for plain CSS
   ======================================== */

/* ========================================
   LAYER 3: Generic (通用层)
   Reset & Normalize
   ======================================== */
/* Obsidian默认样式，无需额外reset */

/* ========================================
   LAYER 4: Base (基础层)
   HTML Element Defaults
   ======================================== */
/* 本项目主要使用类名，基础样式较少 */

/* ========================================
   LAYER 5: Objects (对象层)
   Layout Structures (No Visuals)
   ======================================== */

/* View Root: 确保 Obsidian 视图内容区域使用 flex 布局，让子元素填满空间 */
[data-type="gantt-calendar-view"] > .view-content {
	display: flex;
	flex-direction: column;
	overflow: hidden;
}

/* Main Container */
.calendar-content {
	padding: 12px;
	flex: 1;
	display: flex;
	flex-direction: column;
	overflow-y: auto;
	overflow-x: hidden;
}

/* Calendar Grid Layouts */
.gc-week-view__grid {
	display: flex;
	flex-direction: column;
	gap: 0;
	margin-top: 0;
	flex: 1;
	overflow: hidden;
	min-height: 0;
	position: relative;
}

.gc-week-view__header-row {
	display: grid;
	grid-template-columns: repeat(7, 1fr);
	gap: 0;
	flex-shrink: 0;
	z-index: 5;
	position: sticky;
	top: 0;
}

.gc-week-view__tasks-grid {
	display: grid;
	grid-template-columns: repeat(7, 1fr);
	gap: 0;
	overflow-y: auto;
	overflow-x: hidden;
	flex: 1 1 auto;
	min-height: 0;
	position: relative;
}

/* ========================================
   月视图单一Grid布局（7行8列）
   ======================================== */
.gc-view.gc-view--month {
	display: grid;
	/* 7行: 第1行星期标题(自动高度) + 6行日期(均分空间，minmax(0,1fr) 允许行缩小到 0 以启用单元格内滚动) */
	grid-template-rows: auto repeat(6, minmax(0, 1fr));
	/* 8列: 第1列周数(40px固定) + 7列星期(均分) */
	grid-template-columns: 40px repeat(7, 1fr);
	gap: 0;
	flex: 1;
	min-height: 0;
	padding: 8px;
	overflow: hidden;
}

/* Week/Day Layout */
.gc-view.gc-view--week {
	display: flex;
	flex-direction: column;
	gap: 0;
	flex: 1;
	overflow: hidden;
	height: 100%;
}

.gc-week-view__days {
	display: grid;
	grid-template-columns: repeat(7, 1fr);
	gap: 12px;
}

/* (Day View removed) */

/* ==================== Task View Layout ==================== */
/* BEM命名: gc-view--task (Modifier) */
.gc-view--task {
	--gc-line-color: var(--background-modifier-border);

	display: flex;
	flex-direction: column;
	gap: 2px;
	padding: 6px 8px;
	flex: 1;
	min-height: 100%;
	overflow: visible;
	width: 100%;
}

/* ========================================
   LAYER 5.5: Color Band & StatusIcon (新色带/状态图标基础样式)
   ======================================== */

/* --- 色带基础（::before 伪元素） --- */
.gc-task-card {
	position: relative;
	padding-left: calc(var(--gc-band-width-default) + 6px);
}
.gc-task-card::before {
	content: '';
	position: absolute;
	left: 0;
	top: 0;
	bottom: 0;
	width: var(--gc-band-width-default);
	border-radius: 2px 0 0 2px;
	background-color: var(--gc-priority-normal);
}

/* 优先级色带颜色 */
.gc-task-card--band-high::before { background-color: var(--gc-priority-high); }
.gc-task-card--band-normal::before { background-color: var(--gc-priority-normal); }
.gc-task-card--band-low::before { background-color: var(--gc-priority-low); }

/* 状态覆盖色带 */
.gc-task-card--completed::before { background-color: var(--gc-status-completed); }
.gc-task-card--canceled::before { background-color: var(--gc-status-canceled); }

/* 已完成/取消整体透明度 + 图标保持清晰 */
.gc-task-card--completed {
	opacity: var(--gc-completed-opacity);
}
.gc-task-card--completed .gc-status-icon {
	opacity: calc(1 / var(--gc-completed-opacity));
}
.gc-task-card--canceled {
	opacity: var(--gc-canceled-opacity);
}
.gc-task-card--canceled .gc-status-icon {
	opacity: calc(1 / var(--gc-canceled-opacity));
}

/* 已完成：删除线 */
.gc-task-card--completed .gc-task-card__text,
.gc-task-card--completed .gc-month-task__title {
	text-decoration: line-through;
}

/* 已取消：删除线 */
.gc-task-card--canceled .gc-task-card__text,
.gc-task-card--canceled .gc-month-task__title {
	text-decoration: line-through;
}

/* 提醒类型斜体 */
.gc-task-card--reminder-italic .gc-task-card__text,
.gc-task-card--reminder-italic .gc-month-task__title {
	font-style: italic;
}

/* v4: 有子条目的任务标题显示下划线，表示可展开 */
/* 注意：不可使用 text-underline-offset，会被 overflow: hidden 裁剪 */
.gc-task-card__text--has-children {
	text-decoration: underline;
	cursor: pointer;
}

/* --- StatusIcon 基础样式 --- */
.gc-status-icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	flex-shrink: 0;
	cursor: pointer;
	user-select: none;
	-webkit-user-select: none;
}
.gc-status-icon--disabled {
	cursor: default;
	opacity: 0.5;
}
.gc-status-icon svg {
	display: block;
}

/* ========================================
   LAYER 6: Components (组件层)
   Complete UI Components
   ======================================== */

/* 6.1 Toolbar Component */
/* BEM命名: gc-toolbar */
.calendar-toolbar,
.gc-toolbar {
	display: flex;
	flex-direction: row;
	align-items: center;
	justify-content: flex-start;
	gap: 12px;
	padding: 12px 16px;
	margin: 8px 12px 16px;
	position: sticky;
	top: 8px;
	border-radius: 14px;
	/* 玻璃效果核心 - 提高透明度 */
	background: color-mix(in srgb, var(--background-primary) 15%, transparent);
	border: 1px solid color-mix(in srgb, var(--background-modifier-border) 50%, transparent);
	/* 多层阴影营造深度 + 顶部高光 */
	box-shadow:
		0 4px 12px rgba(0, 0, 0, 0.06),
		0 8px 24px rgba(0, 0, 0, 0.1),
		inset 0 1px 0 rgba(255, 255, 255, 0.15);
	/* 提升饱和度增强玻璃质感 */
	backdrop-filter: blur(20px) saturate(180%);
	-webkit-backdrop-filter: blur(20px) saturate(180%);
	z-index: 100;
}

.gc-toolbar__left,
.gc-toolbar__center,
.gc-toolbar__right {
	display: flex;
	align-items: center;
	gap: 10px;
}

.gc-toolbar__left {
	flex: 0 1 auto;
}

.gc-toolbar__center {
	flex: 1 1 auto;
	display: flex;
	align-items: center;
	justify-content: center;
	min-width: 0;
	/* 防止内容溢出 */
	overflow: hidden;
}

.gc-toolbar__right {
	flex: 0 1 auto;
	justify-content: flex-end;
	gap: 6px;
}

.gc-nav {
	display: flex;
	align-items: center;
	gap: 12px;
	flex: 1;
}

.gc-toggle-group,
.gc-toolbar__view-toggle-group {
	display: flex;
	align-items: center;
	gap: 8px;
}

.gc-toolbar__view-toggle-btn {
	padding: 6px 12px;
	border: 1px solid var(--background-modifier-border);
	/* 玻璃效果 - 半透明背景 */
	background-color: color-mix(in srgb, var(--background-primary) 25%, transparent);
	border-radius: 6px;
	color: var(--text-normal);
	cursor: pointer;
	transition: all 0.15s ease;
	font-size: 13px;
	/* 按钮玻璃效果 */
	backdrop-filter: blur(8px);
	-webkit-backdrop-filter: blur(8px);
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
}

.gc-toolbar__view-toggle-btn--active {
	background-color: var(--interactive-accent);
	border-color: var(--interactive-accent);
	color: white;
	/* 选中时关闭模糊以提高对比度 */
	backdrop-filter: none;
}

.gc-toolbar__view-toggle-btn:hover {
	background-color: color-mix(in srgb, var(--background-primary) 35%, transparent);
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* BEM: 字段筛选组 */
.gc-toolbar__field-filter-group {
	display: inline-flex;
	align-items: center;
	gap: 1px;
	padding: 1px;
	border-radius: 8px;
	background-color: color-mix(in srgb, var(--background-secondary) 35%, #888 5%);
	box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* BEM: 日期范围筛选组 */
.gc-toolbar__date-filter-group {
	display: inline-flex;
	align-items: center;
	gap: 1px;
	padding: 1px;
	border-radius: 8px;
	background-color: color-mix(in srgb, var(--background-secondary) 70%, #888 10%);
	box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
	flex-wrap: wrap;
}

/* BEM: 日期输入框 */
.gc-toolbar__date-input {
	padding: 4px 2px 4px 6px;
	margin-left: 6px;
	width: 95px;
	border: 1px solid var(--input-border-color);
	border-radius: 4px;
	background-color: var(--background-secondary);
	color: var(--text-normal);
	font-size: 12px;
}

/* BEM: 日期模式按钮 */
.gc-toolbar__date-mode-btn {
	padding: 4px 8px;
	border: none;
	background-color: transparent;
	cursor: pointer;
	font-size: 12px;
	color: var(--text-muted);
	transition: all 0.15s ease;
}

.gc-toolbar__date-mode-btn:hover {
	background-color: var(--background-modifier-hover);
	color: var(--text-normal);
}

.gc-toolbar__date-mode-btn.active {
	background-color: #ff6b4a;
	border-color: #ff6b4a;
	color: white;
}

/* BEM: 导航按钮组 - 工具栏凹陷底座效果 */
.gc-toolbar__nav-buttons {
	display: flex;
	align-items: center;
	gap: 1px;
	padding: 1px;
	border-radius: 8px;
	background-color: color-mix(in srgb, var(--background-secondary) 35%, #888 5%);
	box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* BEM: 通用工具栏按钮 */
.gc-toolbar__btn {
	padding: 2px 6px;
	border: 1px solid var(--background-modifier-border);
	/* 玻璃效果 */
	background-color: color-mix(in srgb, var(--background-primary) 20%, transparent);
	border-radius: 4px;
	cursor: pointer;
	font-size: 12px;
	color: var(--text-muted);
	transition: all 0.15s ease;
	min-width: 24px;
	text-align: center;
	backdrop-filter: blur(6px);
	-webkit-backdrop-filter: blur(6px);
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
}

.gc-toolbar__btn:hover {
	background-color: color-mix(in srgb, var(--background-primary) 30%, transparent);
	color: var(--text-normal);
	border-color: var(--interactive-normal);
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
}

/* 导航按钮内的按钮 - 覆盖通用样式，适配凹陷底座 */
.gc-toolbar__nav-buttons .gc-toolbar__btn {
	padding: 4px 2px;
	border: none;
	background-color: transparent;
	color: var(--text-normal);
	cursor: pointer;
	font-size: 13px;
	min-width: 20px;
	text-align: center;
	backdrop-filter: none;
	box-shadow: none;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* 只含图标的按钮（左右箭头）- 稍大一点以容纳图标 */
.gc-toolbar__nav-buttons .gc-toolbar__btn:has(svg) {
	min-width: 24px;
	padding: 4px 4px;
}

/* 导航按钮内的按钮 - 简单悬停效果 */
.gc-toolbar__nav-buttons .gc-toolbar__btn:hover {
	background-color: var(--background-modifier-hover);
	color: var(--text-normal);
	border-color: transparent;
	box-shadow: none;
}

/* 导航按钮激活状态 */
.gc-toolbar__nav-buttons .gc-toolbar__btn.active {
	background-color: var(--interactive-accent);
	color: var(--text-on-accent);
}

.gc-toolbar__title-display {
	font-weight: 600;
	color: var(--text-normal);
	text-align: center;
	white-space: nowrap;
	/* 防止标题溢出，显示省略号 */
	overflow: hidden;
	text-overflow: ellipsis;
	max-width: 100%;
}

/* BEM: 视图选择器 */
.gc-toolbar__view-selector {
	display: flex;
	gap: 6px;
	justify-content: center;
}

/* ============================================
   6视图按钮组样式 (BEM: gc-toolbar__view-selector-group)
   参考设计: bg-black/20 凹陷容器 + 激活按钮凸起效果
   ============================================ */

/* 按钮组容器 - 凹陷底座效果 */
.gc-toolbar__view-selector-group {
	display: flex;
	align-items: center;
	gap: 0; /* 按钮紧密相邻，无间距 */
	padding: 4px; /* p-1 */
	border-radius: 8px; /* rounded-lg */
	/* 与灰色混合，产生轻微差异的背景色 */
	background-color: color-mix(in srgb, var(--background-secondary) 35%, #888 5%);
	/* 轻微 inset 阴影产生凹陷效果 */
	box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* 单个按钮 */
/* 使用 button 元素选择器提高特异性 (0,2,1)，并使用 !important 确保核心样式不被覆盖 */
.gc-toolbar__view-selector-group button.gc-toolbar__view-selector-btn {
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 4px;
	padding: 4px 8px !important;
	border: none !important;
	border-radius: 6px !important; /* rounded */
	background-color: transparent !important;
	/* 使用 Obsidian 变量确保主题兼容性 */
	color: var(--text-normal);
	cursor: pointer;
	/* 分属性过渡，背景色快速，transform 中速，阴影慢速 */
	transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease, transform 0.15s ease, font-weight 0.1s ease;
	font-size: 13px !important;
	font-weight: 500;
	min-width: 0;
	/* 重置可能的主题样式 */
	box-shadow: none !important;
	text-shadow: none !important;
	/* 防止主题设置背景图片 */
	background-image: none !important;
}

/* 按钮内容容器 */
.gc-toolbar__view-selector-btn .view-selector-btn-content {
	display: flex;
	align-items: center;
	gap: 6px;
}

/* 图标 */
.gc-toolbar__view-selector-icon {
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 16px;
	width: 18px;
	height: 18px;
	flex-shrink: 0;
}

/* 文字标签 */
.gc-toolbar__view-selector-label {
	line-height: 1;
}

/* 悬停状态 - 复用激活按钮的凸起效果 */
.gc-toolbar__view-selector-group button.gc-toolbar__view-selector-btn:hover:not(.gc-toolbar__view-selector-btn--active) {
	/* 使用强调色混合半透明背景，避免使用 opacity 实现平滑过渡 */
	background-color: color-mix(in srgb, var(--interactive-accent) 70%, transparent) !important;
	/* 凸起阴影效果 */
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
	/* 白色文字 */
	color: var(--text-on-accent) !important;
	transform: translateY(-1px);
}

/* 激活状态 - 凸起效果 */
/* 使用 button 元素选择器提高特异性 (0,2,1)，并使用 !important 确保核心样式不被覆盖 */
.gc-toolbar__view-selector-group button.gc-toolbar__view-selector-btn--disabled {
	opacity: 0.35;
	cursor: not-allowed;
	pointer-events: none;
}

.gc-toolbar__view-selector-group button.gc-toolbar__view-selector-btn--active {
	/* 使用 Obsidian 强调色作为背景，使激活状态更明显 */
	background-color: var(--interactive-accent) !important;
	/* 凸起阴影效果 */
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15) !important;
	/* 白色文字 */
	color: var(--text-on-accent) !important;
	font-weight: 600;
	transform: translateY(-1px);
}

/* ============================================
   响应式适配 - 基于容器宽度的响应式布局
   ============================================ */

/* 紧凑模式 - 当中间区域文本溢出时，左侧视图按钮只显示图标 */
.gc-toolbar--compact .gc-toolbar__view-selector-group .gc-toolbar__view-selector-label {
	display: none !important;
}

.gc-toolbar--compact .gc-toolbar__view-selector-group .gc-toolbar__view-selector-btn {
	padding: 6px 10px;
	min-width: 36px;
}

/* 仅图标模式 - 通过设置项控制 */
.gc-toolbar__view-selector-group--icon-only .gc-toolbar__view-selector-label {
	display: none !important;
}

.gc-toolbar__view-selector-group--icon-only .gc-toolbar__view-selector-btn {
	padding: 6px 10px;
	min-width: 36px;
}

/* 按钮隐藏状态 - 用于响应式管理器动态隐藏 */
.gc-toolbar__item--hidden {
	display: none !important;
}

/* 右侧区域包装容器样式 */
.gc-toolbar__right > div {
	display: flex;
	align-items: center;
}

/* 平滑过渡效果 */
.gc-toolbar__right > div {
	transition: opacity 0.15s ease;
}

/* 保持原有的媒体查询作为后备方案（针对窗口宽度的响应） */
/* 中等屏幕 (< 900px) - 视图按钮只显示图标 */
@media (max-width: 900px) {
	.gc-toolbar__view-selector-group button.gc-toolbar__view-selector-btn {
		padding: 6px 8px !important;
		min-width: 32px;
	}

	.gc-toolbar__view-selector-group button.gc-toolbar__view-selector-btn .gc-toolbar__view-selector-label {
		display: none;
	}

	.gc-toolbar__view-selector-group button.gc-toolbar__view-selector-btn--active .gc-toolbar__view-selector-label {
		display: inline;
	}
}

/* 小屏幕 (< 700px) - 隐藏工具栏部分次要功能 */
@media (max-width: 700px) {
	/* 减小工具栏内边距 */
	.calendar-toolbar,
	.gc-toolbar {
		gap: 8px;
	}

	/* 缩小按钮间距 */
	.gc-toolbar__left,
	.gc-toolbar__center,
	.gc-toolbar__right {
		gap: 6px;
	}
}

/* 极小屏幕 (< 550px) - 进一步优化 */
@media (max-width: 550px) {
	/* 激活按钮也只显示图标 */
	.gc-toolbar__view-selector-group button.gc-toolbar__view-selector-btn--active .gc-toolbar__view-selector-label {
		display: none;
	}

	/* 标题字体缩小 */
	.gc-toolbar__title-display {
		font-size: 13px;
	}

	/* 导航按钮缩小 */
	.gc-nav__btn {
		padding: 4px 8px;
		font-size: 12px;
	}
}

/* ============================================
 * 中间导航标题（◀ 标题 ▶）
 * ============================================ */

.gc-toolbar__center-nav {
	display: flex;
	align-items: center;
	gap: 4px;
}

button.gc-toolbar__center-nav-prev,
button.gc-toolbar__center-nav-next {
	all: unset;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	color: var(--text-faint);
	opacity: 0.45;
	transition: opacity 0.2s ease, color 0.2s ease;
	line-height: 1;
}

button.gc-toolbar__center-nav-prev:hover,
button.gc-toolbar__center-nav-next:hover {
	color: var(--text-normal);
	opacity: 1;
}

button.gc-toolbar__center-nav-prev svg,
button.gc-toolbar__center-nav-next svg {
	width: 14px;
	height: 14px;
}

.gc-toolbar__center-nav-title {
	font-weight: 600;
	color: var(--text-normal);
	white-space: nowrap;
	user-select: none;
	padding: 2px 6px;
	border-radius: 4px;
	transition: background-color 0.15s ease, text-decoration 0.15s ease;
}

.gc-toolbar__center-nav-title:hover {
	background-color: var(--background-modifier-hover);
	text-decoration: underline;
}

/* ============================================
 * 视图菜单弹窗
 * ============================================ */

.gc-toolbar__view-menu-btn {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding: 4px 8px;
	border: 1px solid var(--background-modifier-border);
	background: color-mix(in srgb, var(--background-primary) 20%, transparent);
	border-radius: 6px;
	cursor: pointer;
	color: var(--text-muted);
	transition: all 0.15s ease;
}

.gc-toolbar__view-menu-btn:hover {
	color: var(--text-normal);
	background-color: var(--background-modifier-hover);
	border-color: var(--interactive-normal);
}

.gc-toolbar__view-menu-btn--active {
	color: var(--interactive-accent);
	border-color: var(--interactive-accent);
	background-color: color-mix(in srgb, var(--interactive-accent) 10%, transparent);
}

.gc-toolbar__view-menu-btn svg {
	width: 16px;
	height: 16px;
}

.gc-toolbar__view-menu-panel {
	background: var(--background-primary);
	border: 1px solid var(--background-modifier-border);
	border-radius: 10px;
	padding: 12px;
	min-width: 220px;
	max-width: 300px;
	max-height: 400px;
	overflow-y: auto;
	box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
	display: flex;
	flex-direction: column;
	gap: 8px;
}

.gc-toolbar__view-menu-section {
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.gc-toolbar__view-menu-section + .gc-toolbar__view-menu-section {
	border-top: 1px solid var(--background-modifier-border);
	padding-top: 8px;
}

.gc-toolbar__view-menu-section-title {
	font-size: 11px;
	font-weight: 600;
	text-transform: uppercase;
	color: var(--text-muted);
	letter-spacing: 0.5px;
	margin-bottom: 2px;
}

.gc-toolbar__view-menu-checkbox-item {
	display: flex;
	align-items: center;
	gap: 6px;
	padding: 3px 4px;
	border-radius: 4px;
	cursor: pointer;
	font-size: 13px;
	color: var(--text-normal);
}

.gc-toolbar__view-menu-checkbox-item:hover {
	background-color: var(--background-modifier-hover);
}

.gc-toolbar__view-menu-checkbox {
	margin: 0;
	cursor: pointer;
}

.gc-toolbar__view-menu-sort-row {
	display: flex;
	align-items: center;
	gap: 6px;
}

.gc-toolbar__view-menu-sort-field {
	flex: 1;
	padding: 4px 6px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	background: var(--background-secondary);
	color: var(--text-normal);
	font-size: 13px;
}

.gc-toolbar__view-menu-sort-order {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding: 4px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	background: var(--background-secondary);
	cursor: pointer;
	color: var(--text-muted);
	transition: color 0.15s ease;
}

.gc-toolbar__view-menu-sort-order:hover {
	color: var(--text-normal);
}

.gc-toolbar__view-menu-sort-order svg {
	width: 14px;
	height: 14px;
}

.gc-toolbar__view-menu-row {
	display: flex;
	align-items: center;
	gap: 6px;
	flex-wrap: wrap;
}

.gc-toolbar__view-menu-label {
	font-size: 12px;
	color: var(--text-muted);
}

.gc-toolbar__view-menu-select {
	padding: 4px 6px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	background: var(--background-secondary);
	color: var(--text-normal);
	font-size: 13px;
}

/* ============================================
 * 快捷预设按钮 + 下拉
 * ============================================ */

.gc-toolbar__preset-btn {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding: 4px 8px;
	border: 1px solid var(--background-modifier-border);
	background: color-mix(in srgb, var(--background-primary) 20%, transparent);
	border-radius: 6px;
	cursor: pointer;
	color: var(--text-muted);
	transition: all 0.15s ease;
}

.gc-toolbar__preset-btn:hover {
	color: var(--text-normal);
	background-color: var(--background-modifier-hover);
	border-color: var(--interactive-normal);
}

.gc-toolbar__preset-btn--active {
	color: var(--interactive-accent);
	border-color: var(--interactive-accent);
}

.gc-toolbar__preset-btn svg {
	width: 16px;
	height: 16px;
}

.gc-toolbar__preset-dropdown {
	background: var(--background-primary);
	border: 1px solid var(--background-modifier-border);
	border-radius: 10px;
	padding: 6px;
	min-width: 160px;
	box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
	display: flex;
	flex-direction: column;
	gap: 2px;
}

.gc-toolbar__preset-item {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 6px 10px;
	border-radius: 6px;
	cursor: pointer;
	transition: background-color 0.1s ease;
}

.gc-toolbar__preset-item:hover {
	background-color: var(--background-modifier-hover);
}

.gc-toolbar__preset-item--default {
	font-weight: 600;
}

.gc-toolbar__preset-item--default::after {
	content: '●';
	font-size: 8px;
	color: var(--interactive-accent);
	margin-left: auto;
}

.gc-toolbar__preset-icon svg {
	width: 14px;
	height: 14px;
	color: var(--text-muted);
}

.gc-toolbar__preset-name {
	font-size: 13px;
	color: var(--text-normal);
}

/* ============================================
   工具栏组件样式 (BEM: gc-toolbar)
   ============================================ */

/* BEM: 通用按钮组样式 */
.gc-toolbar__button-group {
	display: inline-flex;
	align-items: center;
	gap: 4px;
}

.gc-toolbar__button-group--horizontal {
	flex-direction: row;
}

.gc-toolbar__button-group--vertical {
	flex-direction: column;
}

/* BEM: 输入组样式 */
.gc-toolbar__input-group {
	display: inline-flex;
	align-items: center;
	gap: 6px;
}

/* BEM: 模式切换组样式 */
.gc-toolbar__mode-toggle-group {
	display: inline-flex;
	align-items: center;
	gap: 4px;
}

.gc-toolbar__mode-icon {
	font-size: 12px;
}

.gc-toolbar__mode-label {
	font-size: 13px;
	color: var(--text-normal);
}

/* 时间颗粒度按钮 */
.gc-toolbar__today-btn {
	padding: 4px 10px;
	border: none;
	border-radius: 4px;
	background-color: var(--background-modifier-hover);
	color: var(--text-normal);
	font-size: 13px;
	cursor: pointer;
	transition: all 0.2s ease;
}

.gc-toolbar__today-btn:hover {
	background-color: var(--interactive-accent);
	color: var(--text-on-accent);
}

.gc-toolbar__time-granularity-btn {
	padding: 4px 12px;
	border: none;
	border-radius: 4px;
	background-color: transparent;
	color: var(--text-muted);
	font-size: 13px;
	cursor: pointer;
	transition: all 0.2s ease;
}

.gc-toolbar__time-granularity-btn:hover {
	background-color: var(--background-modifier-hover);
	color: var(--text-normal);
}

.gc-toolbar__time-granularity-btn--active {
	background-color: var(--interactive-accent);
	color: var(--text-on-accent);
	font-weight: 600;
}

/* ============================================
   状态筛选按钮样式（复选框多选模式，现代 UI）
   ============================================ */

/* 状态筛选容器 - 下凹设计 */
.gc-toolbar__status-filter-container {
	display: inline-flex;
	gap: 1px;
	padding: 1px;
	border-radius: 8px;
	background-color: color-mix(in srgb, var(--background-secondary) 35%, #888 5%);
	box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* 状态筛选按钮 - 下凹设计 */
.gc-toolbar__status-filter-btn {
	position: relative;
	display: inline-flex;
	align-items: center;
	gap: 6px;
	padding: 4px 8px;
	border: none;
	border-radius: 0;
	background: transparent;
	color: var(--text-muted);
	font-size: 13px;
	cursor: pointer;
	transition: all 0.2s ease;
}

.gc-toolbar__status-filter-btn:hover {
	background: var(--background-modifier-hover);
	color: var(--text-normal);
}

.gc-toolbar__status-filter-btn--has-selection {
	background: var(--interactive-accent);
	color: var(--text-on-accent);
}

.gc-toolbar__status-filter-icon {
	display: flex;
	align-items: center;
	justify-content: center;
}

.gc-toolbar__status-filter-icon svg {
	display: block;
}

/* ============================================
   状态筛选下拉面板样式
   ============================================ */

.gc-toolbar__status-filter-dropdown {
	position: fixed;
	z-index: 1000;
	min-width: 200px;
	max-width: 240px;
	background: color-mix(in srgb, var(--background-primary) 20%, transparent);
	border: 1px solid color-mix(in srgb, var(--background-modifier-border) 50%, transparent);
	border-radius: 8px;
	box-shadow:
		0 8px 24px rgba(0, 0, 0, 0.12),
		0 2px 6px rgba(0, 0, 0, 0.08),
		inset 0 1px 0 rgba(255, 255, 255, 0.15);
	padding: 0;
	overflow: hidden;
	backdrop-filter: blur(20px) saturate(180%);
	-webkit-backdrop-filter: blur(20px) saturate(180%);
}

.gc-toolbar__status-filter-dropdown-header {
	padding: 12px 16px;
	border-bottom: 1px solid color-mix(in srgb, var(--background-modifier-border) 40%, transparent);
	font-size: 13px;
	font-weight: 600;
	color: var(--text-normal);
}

.gc-toolbar__status-filter-dropdown-actions {
	padding: 8px 16px;
	border-bottom: 1px solid color-mix(in srgb, var(--background-modifier-border) 40%, transparent);
	display: flex;
	justify-content: flex-end;
}

.gc-toolbar__status-filter-dropdown-actions button {
	padding: 4px 12px;
	border: none;
	border-radius: 4px;
	background: transparent;
	color: var(--text-muted);
	font-size: 12px;
	cursor: pointer;
	transition: all 0.15s ease;
}

.gc-toolbar__status-filter-dropdown-actions button:hover {
	background: var(--background-modifier-hover);
	color: var(--text-normal);
}

.gc-toolbar__status-filter-list {
	max-height: 280px;
	overflow-y: auto;
	padding: 4px;
}

.gc-toolbar__status-filter-list::-webkit-scrollbar {
	width: 6px;
}

.gc-toolbar__status-filter-list::-webkit-scrollbar-track {
	background: transparent;
}

.gc-toolbar__status-filter-list::-webkit-scrollbar-thumb {
	background: var(--background-modifier-border);
	border-radius: 3px;
}

.gc-toolbar__status-filter-item {
	display: flex;
	align-items: center;
	gap: 10px;
	padding: 8px 10px;
	border-radius: 6px;
	cursor: pointer;
	transition: all 0.15s ease;
}

.gc-toolbar__status-filter-item:hover {
	background: color-mix(in srgb, var(--interactive-accent) 15%, transparent);
	backdrop-filter: blur(8px);
}

.gc-toolbar__status-filter-item--selected {
	background: color-mix(in srgb, var(--interactive-accent) 25%, transparent);
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

/* 复选框 */
.gc-toolbar__status-checkbox svg {
	display: block;
	flex-shrink: 0;
}

/* 状态标签 - 胶囊样式 */
.gc-toolbar__status-label {
	flex: 0 0 auto;
	display: inline-flex;
	align-items: center;
	padding: 4px 10px;
	border-radius: 12px;
	font-size: 13px;
	line-height: 1;
	white-space: nowrap;
}

/* 空状态 */
.gc-toolbar__status-filter-empty {
	padding: 24px 16px;
	text-align: center;
	color: var(--text-muted);
	font-size: 12px;
}

/* 排序按钮 */
.gc-toolbar__sort-btn {
	padding: 4px 10px;
	border: none;
	border-radius: 4px;
	background-color: transparent;
	color: var(--text-normal);
	font-size: 13px;
	cursor: pointer;
	transition: all 0.2s ease;
	display: inline-flex;
	align-items: center;
	gap: 4px;
}

.gc-toolbar__sort-btn:hover {
	background-color: var(--background-modifier-hover);
}

/* 标签筛选按钮 */
.gc-toolbar__tag-filter-btn {
	padding: 4px 10px;
	border: none;
	border-radius: 4px;
	background-color: transparent;
	color: var(--text-normal);
	font-size: 13px;
	cursor: pointer;
	transition: all 0.2s ease;
	display: inline-flex;
	align-items: center;
	gap: 4px;
}

.gc-toolbar__tag-filter-btn:hover {
	background-color: var(--background-modifier-hover);
}

.gc-toolbar__tag-filter-btn--has-selection {
	background-color: var(--interactive-accent);
	color: var(--text-on-accent);
}

/* 标签筛选按钮图标 */
.gc-toolbar__tag-filter-icon {
	font-size: 12px;
	line-height: 1;
}

/* 标签筛选数量徽章 */
.gc-toolbar__tag-filter-count {
	background-color: var(--interactive-accent);
	color: white;
	font-size: 9px;
	font-weight: 600;
	padding: 1px 4px;
	border-radius: 6px;
	min-width: 14px;
	text-align: center;
	line-height: 1.1;
}

.gc-toolbar__tag-filter-btn--has-selection .gc-toolbar__tag-filter-count {
	background-color: white;
	color: var(--interactive-accent);
}

/* 字段选择器 */
.gc-toolbar__field-selector-label {
	display: none;
}

.gc-toolbar__field-selector-select {
	padding: 4px 8px;
	border: none;
	border-radius: 4px;
	background-color: transparent;
	color: var(--text-normal);
	font-size: 12px;
	cursor: pointer;
}

/* ============================================
   排序下拉菜单样式 (BEM: gc-toolbar)
   ============================================ */

.gc-toolbar__sort-dropdown {
	position: fixed;
	z-index: 1000;
	background: color-mix(in srgb, var(--background-primary) 20%, transparent);
	border: 1px solid color-mix(in srgb, var(--background-modifier-border) 50%, transparent);
	border-radius: 6px;
	padding: 4px 0;
	min-width: 160px;
	box-shadow:
		0 8px 24px rgba(0, 0, 0, 0.12),
		0 2px 6px rgba(0, 0, 0, 0.08),
		inset 0 1px 0 rgba(255, 255, 255, 0.15);
	backdrop-filter: blur(20px) saturate(180%);
	-webkit-backdrop-filter: blur(20px) saturate(180%);
}

.gc-toolbar__sort-dropdown-header {
	padding: 8px 12px;
	font-size: 11px;
	color: var(--text-muted);
	border-bottom: 1px solid color-mix(in srgb, var(--background-modifier-border) 40%, transparent);
	margin-bottom: 4px;
}

.gc-toolbar__sort-menu-item {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 8px 12px;
	cursor: pointer;
	transition: all 0.15s ease;
	user-select: none;
}

.gc-toolbar__sort-menu-item:hover {
	background: color-mix(in srgb, var(--interactive-accent) 15%, transparent);
	backdrop-filter: blur(8px);
}

.gc-toolbar__sort-menu-item--active {
	background: color-mix(in srgb, var(--interactive-accent) 25%, transparent);
	color: var(--interactive-accent);
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.gc-toolbar__sort-option-icon {
	font-size: 14px;
	width: 20px;
	text-align: center;
}

.gc-toolbar__sort-option-label {
	flex: 1;
	font-size: 13px;
}

.gc-toolbar__sort-option-indicator {
	font-size: 12px;
	width: 20px;
	text-align: right;
}

.gc-toolbar__sort-icon {
	font-size: 14px;
}

.gc-toolbar__sort-dropdown-icon {
	font-size: 10px;
	opacity: 0.7;
}

/* ============================================
   标签筛选下拉菜单样式 (BEM: gc-toolbar)
   ============================================ */

.gc-toolbar__tag-filter-pane {
	position: fixed;
	z-index: 1000;
	background: color-mix(in srgb, var(--background-primary) 20%, transparent);
	border: 1px solid color-mix(in srgb, var(--background-modifier-border) 50%, transparent);
	border-radius: 6px;
	padding: 4px 6px;
	min-width: 140px;
	max-width: 180px;
	max-height: 280px;
	overflow-y: auto;
	box-shadow:
		0 8px 24px rgba(0, 0, 0, 0.12),
		0 2px 6px rgba(0, 0, 0, 0.08),
		inset 0 1px 0 rgba(255, 255, 255, 0.15);
	backdrop-filter: blur(20px) saturate(180%);
	-webkit-backdrop-filter: blur(20px) saturate(180%);
}

.gc-toolbar__tag-filter-pane::-webkit-scrollbar {
	width: 4px;
}

.gc-toolbar__tag-filter-pane::-webkit-scrollbar-track {
	background: transparent;
}

.gc-toolbar__tag-filter-pane::-webkit-scrollbar-thumb {
	background: var(--background-modifier-border);
	border-radius: 2px;
}

.gc-toolbar__tag-filter-pane::-webkit-scrollbar-thumb:hover {
	background: var(--text-muted);
}

.gc-toolbar__tag-filter-operators {
	display: flex;
	gap: 1px;
	padding-bottom: 3px;
	margin-bottom: 4px;
	border-bottom: 1px solid color-mix(in srgb, var(--background-modifier-border) 40%, transparent);
}

.gc-toolbar__tag-filter-operator-btn {
	flex: 0 1 auto;
	padding: 2px 3px;
	border: 1px solid var(--background-modifier-border);
	background: var(--background-primary);
	border-radius: 3px;
	cursor: pointer;
	font-size: 10px;
	font-weight: 500;
	color: var(--text-muted);
	transition: all 0.12s ease;
	text-align: center;
	line-height: 1.4;
	min-width: 24px;
}

.gc-toolbar__tag-filter-operator-btn:hover {
	background: var(--background-modifier-hover);
}

.gc-toolbar__tag-filter-operator-btn--active {
	background: var(--interactive-accent);
	color: white;
	border-color: var(--interactive-accent);
}

.gc-toolbar__tag-filter-tags-grid {
	display: flex;
	flex-wrap: wrap;
	gap: 3px;
}

.gc-toolbar__tag-filter-empty {
	padding: 12px;
	text-align: center;
	color: var(--text-muted);
	font-size: 11px;
}

.gc-toolbar__tag-filter-tag-item {
	display: inline-flex;
	align-items: center;
	gap: 2px;
	padding: 2px 5px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 10px;
	background: var(--background-primary);
	cursor: pointer;
	transition: all 0.12s ease;
	user-select: none;
	font-size: 11px;
}

.gc-toolbar__tag-filter-tag-item:hover {
	background: var(--background-modifier-hover);
	border-color: var(--background-modifier-border-hover);
}

/* 选中状态 - 更显眼的样式 */
.gc-toolbar__tag-filter-tag-item--selected {
	/* 使用深色渐变背景，确保白色文字清晰可见 */
	background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
	border-color: #7c3aed;
	color: rgb(15, 14, 14);
	/* 添加外发光效果 */
	box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.3), 0 2px 8px rgba(139, 92, 246, 0.4);
	/* 轻微放大 */
	transform: scale(1.05);
}

.gc-toolbar__tag-filter-tag-name {
	font-size: 11px;
	font-weight: 500;
	color: var(--text-normal);
	line-height: 1.2;
}

.gc-toolbar__tag-filter-tag-item--selected .gc-toolbar__tag-filter-tag-name {
	color: white;
	font-weight: 600;
	text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.gc-toolbar__tag-filter-tag-count {
	font-size: 9px;
	color: var(--text-muted);
	background: var(--background-modifier-border);
	padding: 1px 4px;
	border-radius: 6px;
	font-weight: 500;
	line-height: 1;
}

.gc-toolbar__tag-filter-tag-item--selected .gc-toolbar__tag-filter-tag-count {
	background: rgba(255, 255, 255, 0.9);
	color: #7c3aed;
	font-weight: 600;
}

/* 选中状态的悬停 - 保持紫色效果 */
.gc-toolbar__tag-filter-tag-item--selected:hover {
	background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
	border-color: #7c3aed;
	box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.4), 0 4px 12px rgba(139, 92, 246, 0.5);
	transform: scale(1.08);
}

/* 响应式适配 */
@media (max-width: 768px) {
	.gc-toolbar__tag-filter-pane {
		min-width: 120px;
		max-width: 160px;
	}

	.gc-toolbar__tag-filter-tag-item {
		font-size: 10px;
		padding: 2px 5px;
	}

	.gc-toolbar__tag-filter-tag-name {
		font-size: 10px;
	}

	.gc-toolbar__tag-filter-tag-count {
		font-size: 8px;
		padding: 1px 3px;
	}
}

/* 6.2 Task Card Component (统一任务卡片) */
/* BEM命名: gc-task-card */
/* 注意：padding 由 Layer 5.5 的 padding-left（色带）和各视图修饰符分别控制 */
.gc-task-card {
	display: flex;
	align-items: center;
	background-color: var(--background-secondary);
	border-radius: 4px;
	cursor: pointer;
	transition: background-color 0.15s ease;
}

.gc-task-card:hover {
	background-color: var(--background-modifier-hover);
}

.gc-task-card__text {
	flex: 1;
	word-break: break-word;
	line-height: 1.4;
	color: var(--text-normal);
	overflow: hidden;
	text-overflow: ellipsis;
}

/* 非 Task View 的 fallback */
/* ===== 任务视图：两行结构重写 ===== */
.gc-task-card--task {
	display: flex;
	flex-direction: column;
	align-items: stretch;  /* v4: 覆盖基类的 align-items: center，修复水平居中问题 */
	padding: 4px 6px 4px calc(var(--gc-band-width-default) + 6px);  /* v4: 缩减间距 */
	gap: 2px;              /* v4: 从3px缩减 */
	font-size: 13px;
	border-radius: 4px;
	cursor: pointer;
	background-color: transparent;  /* v4: 从白色改为透明，融入Obsidian背景 */
	transition: background-color 0.15s ease;
}
.gc-task-card--task:hover {
	background-color: var(--background-modifier-hover);
}

/* 第一行：StatusIcon + 标题 + 进度 + 倒计时 */
.gc-task-card__main {
	display: flex;
	align-items: center;
	gap: 6px;
	min-height: 22px;
}
.gc-task-card--task .gc-task-card__text {
	flex: 1;
	min-width: 0;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
	color: var(--text-normal);
}
.gc-task-card__progress {
	flex-shrink: 0;
	font-size: 11px;
	color: var(--text-muted);
}
.gc-task-card__due {
	flex-shrink: 0;
	font-size: 11px;
	color: var(--text-muted);
	white-space: nowrap;
}
.gc-task-card__due--overdue {
	color: var(--gc-status-overdue);
	font-weight: 500;
}

/* 第二行：标签 */
.gc-task-card--task .gc-task-card__tags {
	display: flex;
	flex-wrap: wrap;
	gap: 3px;
	padding-left: calc(var(--gc-icon-size-normal) + 6px); /* StatusIcon 16px + gap 6px = 22px, 对齐标题文字 */
}

/* 任务视图间距 */
.gc-view--task .gc-task-card--task + .gc-task-card--task {
	margin-top: var(--gc-card-gap);
}

.gc-task-card--day {
	padding: 10px;
	gap: 8px;
	flex-wrap: wrap;
	font-size: 13px;
}

.gc-task-card--week {
	padding: 8px;
	gap: 4px;
	font-size: 13px;
	box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* 周视图：给文本添加左侧间距，补偿复选框后的gap */
.gc-task-card--week .gc-task-card__text {
	margin-left: 4px;
}

/* 周视图：移除标签容器的额外左侧间距，避免与文本间距过大 */
.gc-task-card--week .gc-task-card__tags {
	margin-left: 0;
}

.gc-task-card--month {
	padding: 4px 6px;
	font-size: 11px;
	line-height: 1.3;
	border-left-width: 2px;
	border-radius: 3px;
}

/* ==================== Task Tags Component ==================== */
/* BEM命名: gc-tag (独立Block), gc-task-card__tags (作为任务卡Element) */

/* Tags inline container - 任务标签容器 */
.gc-task-card__tags {
	display: flex;
	flex-direction: row;
	align-items: center;
	gap: 4px;
	flex-wrap: wrap;
}

/* ========================================
   Tag 组件统一样式
   BEM: gc-tag
   ======================================== */

/* Block 基础样式 */
.gc-tag {
	display: inline-flex;
	align-items: center;
	gap: 4px;
	font-size: 11px;
	font-weight: 500;
	padding: 3px 8px;
	background-color: var(--background-primary);
	border: 1px solid var(--background-modifier-border);
	border-radius: 12px;
	color: var(--text-normal);
	flex-shrink: 0;
	white-space: nowrap;
	transition: all 0.2s ease;
	cursor: default;
	user-select: none;
}

/* Hover 状态 - 排除已选中状态 */
.gc-tag:not(.gc-tag--selected):hover {
	background-color: var(--background-modifier-hover);
}

/* 可选状态 */
.gc-tag--selectable {
	cursor: pointer;
}

.gc-tag--selectable:active {
	transform: scale(0.96);
}

/* 选中状态 - 紫色发光效果 */
.gc-tag--selected {
	background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
	border-color: #7c3aed;
	color: white;
	box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.3), 0 2px 8px rgba(139, 92, 246, 0.4);
	transform: scale(1.05);
}

.gc-tag--selected .gc-tag__label {
	color: white;
	font-weight: 600;
	text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.gc-tag--selected .gc-tag__suffix {
	background: rgba(255, 255, 255, 0.9);
	color: #7c3aed;
	font-weight: 600;
}

/* 选中状态的悬停 - 保持紫色效果 */
.gc-tag--selected:hover {
	background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
	border-color: #7c3aed;
	box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.4), 0 4px 12px rgba(139, 92, 246, 0.5);
	transform: scale(1.08);
}

/* Elements */
.gc-tag__label {
	line-height: 1.2;
}

.gc-tag__suffix {
	font-size: 9px;
	color: var(--text-muted);
	background-color: var(--background-modifier-border);
	padding: 1px 4px;
	border-radius: 6px;
	font-weight: 500;
	line-height: 1;
}

/* 颜色变体（6种颜色，基于hash自动分配） */
.gc-tag--color-0 {
	background-color: rgba(56, 132, 255, 0.1);
	border-color: rgba(56, 132, 255, 0.2);
	color: #3884ff;
}

.gc-tag--color-1 {
	background-color: rgba(34, 197, 94, 0.1);
	border-color: rgba(34, 197, 94, 0.2);
	color: #22c55e;
}

.gc-tag--color-2 {
	background-color: rgba(249, 115, 22, 0.1);
	border-color: rgba(249, 115, 22, 0.2);
	color: #f97316;
}

.gc-tag--color-3 {
	background-color: rgba(234, 179, 8, 0.1);
	border-color: rgba(234, 179, 8, 0.2);
	color: #eab308;
}

.gc-tag--color-4 {
	background-color: rgba(168, 85, 247, 0.1);
	border-color: rgba(168, 85, 247, 0.2);
	color: #a855f7;
}

.gc-tag--color-5 {
	background-color: rgba(236, 72, 153, 0.1);
	border-color: rgba(236, 72, 153, 0.2);
	color: #ec4899;
}

/* Tooltip Tags */
.gc-task-tooltip__tags {
	display: flex;
	flex-direction: row;
	align-items: center;
	gap: 6px;
	flex-wrap: wrap;
	margin-top: 8px;
	padding: 8px;
	background-color: var(--background-secondary);
	border-radius: 4px;
}

/* ==================== 响应式设计 ==================== */

/* 小屏幕适配 */
@media (max-width: 768px) {
	.gc-tag {
		font-size: 10px;
		padding: 1px 6px;
	}

	.gc-task-card__tags {
		gap: 3px;
	}
}

/* 月视图小屏幕 - 限制标签显示 */
.gc-task-card--month .gc-task-card__tags {
	max-width: 100%;
	overflow: hidden;
}

.gc-task-card--month .gc-tag {
	max-width: 60px;
	overflow: hidden;
	text-overflow: ellipsis;
}

/* 6.4 Month View Components */
/* 星期标签 - 位于Grid第1行 */
.gc-month-view__weekday {
	font-size: 12px;
	font-weight: 500;
	color: var(--text-muted);
	text-align: center;
	padding: 8px 4px;
	/* 网格线：上右有边框 */
	/*border-top: 2px solid var(--background-modifier-border);*/
	border-right: 2px solid var(--background-modifier-border);
	/* 确保在Grid第1行 */
	grid-row: 1;
}

/* 空占位 - 第1行第1列 */
.gc-month-view__weekday--empty {
	visibility: hidden;
}

/* 周编号 - 位于每周的第1列 */
.gc-month-view__week-number {
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 11px;
	font-weight: 600;
	color: var(--text-muted);
	/* 网格线：上右有边框 */
	border-top: 2px solid var(--background-modifier-border);
	border-right: 2px solid var(--background-modifier-border);
	/* grid位置由JavaScript内联样式设置 */
}

/* BEM类名: gc-month-view__day-cell */
.gc-month-view__day-cell {
	min-height: 0;  /* 允许 grid 1fr 限制高度，而非 flex 默认的 auto */
	display: flex;
	flex-direction: column;
	align-items: stretch;
	justify-content: flex-start;
	padding: var(--gc-month-cell-padding);
	gap: 2px;
	background-color: var(--background-primary);
	/* 网格线：上右有边框，左下由相邻单元格提供 */
	border-top: 2px solid var(--background-modifier-border);
	border-right: 2px solid var(--background-modifier-border);
	cursor: pointer;
	transition: all 0.15s ease;
	overflow: hidden;
}

/* 日期头部：日期数字和农历文本的横向布局容器 */
.gc-month-view__day-header {
	display: flex;
	flex-direction: row;
	justify-content: center;
	align-items: center;
	width: 100%;
	padding: 0 25%;
	margin-bottom: 4px;
	border-bottom: 1px solid var(--background-modifier-border);
	gap: 8px;
}

/* 日期头部中间的分隔圆点 */
.gc-month-view__day-header-separator {
	width: 4px;
	height: 4px;
	background-color: var(--text-muted);
	border-radius: 50%;
	flex-shrink: 0;
}

/* BEM类名: gc-month-view__day-number */
.gc-month-view__day-cell .gc-month-view__day-number {
	font-size: 18px;
	font-weight: 500;
	color: var(--text-normal);
}

/* BEM类名: gc-month-view__lunar-text */
.gc-month-view__day-cell .gc-month-view__lunar-text {
	font-size: 11px;
	font-weight: 400;
	color: var(--text-muted);
}

/* BEM类名: gc-month-view__tasks */
.gc-month-view__tasks {
	display: flex;
	flex-direction: column;
	gap: var(--gc-month-task-gap);
	width: 100%;
	margin-top: 2px;
	flex: 1;
	min-height: 0;
	overflow-y: auto;
	overflow-x: hidden;
	/* 隐藏滚动条但保留滚动功能（月视图格子空间有限，滚动条会占用宝贵空间） */
	scrollbar-width: none; /* Firefox */
	-ms-overflow-style: none; /* IE 10+ */
}

.gc-month-view__tasks::-webkit-scrollbar {
	display: none; /* Chrome, Safari, Opera */
}

/* ===== 月视图任务条目（轻量 DOM） ===== */
.gc-month-task {
	display: flex;
	align-items: center;
	gap: 3px;
	padding: 1px 3px;
	border-radius: 3px;
	cursor: pointer;
	position: relative;
	padding-left: calc(var(--gc-band-width-default) + 4px);
	min-height: 20px;
	line-height: 1.3;
}
.gc-month-task:hover {
	background-color: var(--background-modifier-hover);
}
/* 色带 ::before */
.gc-month-task::before {
	content: '';
	position: absolute;
	left: 0;
	top: 0;
	bottom: 0;
	width: var(--gc-band-width-default);
	border-radius: 3px 0 0 3px;
	background-color: var(--gc-priority-normal);
}
/* 色带优先级颜色 */
.gc-month-task--band-high::before { background-color: var(--gc-priority-high); }
.gc-month-task--band-normal::before { background-color: var(--gc-priority-normal); }
.gc-month-task--band-low::before { background-color: var(--gc-priority-low); }
.gc-month-task--band-completed::before { background-color: var(--gc-status-completed); }
.gc-month-task--band-canceled::before { background-color: var(--gc-status-canceled); }

/* 标题 */
.gc-month-task__title {
	flex: 1;
	min-width: 0;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
	font-size: 12px;
	color: var(--text-normal);
}
/* 提醒斜体 */
.gc-month-task--reminder .gc-month-task__title {
	font-style: italic;
}
/* 过期红色标题 */
.gc-month-task--overdue .gc-month-task__title {
	color: var(--gc-status-overdue);
}
/* 完成：删除线 + 透明度 */
.gc-month-task--completed {
	opacity: var(--gc-completed-opacity);
}
.gc-month-task--completed .gc-month-task__title {
	text-decoration: line-through;
	color: var(--text-muted);
}
.gc-month-task--completed .gc-status-icon {
	opacity: calc(1 / var(--gc-completed-opacity));
}
/* 取消：删除线 + 透明度 */
.gc-month-task--canceled {
	opacity: var(--gc-canceled-opacity);
}
.gc-month-task--canceled .gc-month-task__title {
	text-decoration: line-through;
	color: var(--text-muted);
}
.gc-month-task--canceled .gc-status-icon {
	opacity: calc(1 / var(--gc-canceled-opacity));
}

/* 进度 [n/m] */
.gc-month-task__progress {
	flex-shrink: 0;
	font-size: 10px;
	color: var(--text-muted);
	margin-left: 2px;
}

.gc-week-view__tasks-column {
	border-right: 1px solid var(--background-modifier-border);
	padding: 8px;
	overflow-y: auto;
	overflow-x: hidden;
	display: flex;
	flex-direction: column;
	gap: 8px;
	background-color: var(--background-primary);
}

.gc-week-view__tasks-column:last-child {
	border-right: none;
}

.gc-week-view__header-cell {
	padding: 12px 20%;
	text-align: center;
	border-right: 1px solid var(--background-modifier-border);
	border-bottom: 2px solid var(--background-modifier-border);
	display: flex;
	flex-direction: row;
	align-items: center;
	justify-content: space-between;
	gap: 6px;
	background-color: var(--background-primary);
	position: sticky;
	top: 0;
	z-index: 4;
}

.gc-week-view__header-cell:last-child {
	border-right: none;
}

.gc-week-view__day-name {
	flex: 1;
	font-size: 12px;
	font-weight: 500;
	color: var(--text-normal);
	text-align: left;
}

.gc-week-view__day-number {
	flex: 1;
	font-size: 13px;
	font-weight: 500;
	color: var(--text-normal);
	text-align: center;
}

.gc-week-view__lunar-text {
	flex: 1;
	font-size: 12px;
	font-weight: 400;
	color: var(--text-muted);
	text-align: right;
}

/* ==================== Task Tooltip ==================== */
/* BEM命名: gc-task-tooltip */
.gc-task-tooltip {
	position: fixed;
	z-index: 1000;
	background-color: var(--background-primary);
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
	padding: 12px;
	max-width: 300px;
	min-width: 250px;
	font-size: 13px;
	line-height: 1.5;
	pointer-events: none;
	opacity: 0;
	transform: translateY(-8px) scale(0.95);
	transition: opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1),
	            transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.gc-task-tooltip--visible {
	opacity: 1;
	transform: translateY(0) scale(1);
}

.gc-task-tooltip .gc-task-tooltip__description {
	margin-bottom: 8px;
	padding-bottom: 8px;
	border-bottom: 1px solid var(--divider-color);
	color: var(--text-normal);
	word-break: break-word;
}

.gc-task-tooltip .gc-task-tooltip__description strong {
	font-weight: 600;
	font-size: 14px;
}

.gc-task-tooltip .gc-task-tooltip__priority {
	margin-bottom: 8px;
	padding: 4px 0;
	font-weight: 500;
}

.gc-task-tooltip .priority-high {
	color: #d73a49;
}

.gc-task-tooltip .priority-normal {
	color: #6b7280;
}

.gc-task-tooltip .priority-low {
	color: #0366d6;
}

.gc-task-tooltip .gc-task-tooltip__times {
	display: flex;
	flex-direction: column;
	gap: 4px;
	margin-bottom: 8px;
	padding: 8px;
	background-color: var(--background-secondary);
	border-radius: 4px;
}

.gc-task-tooltip .gc-task-tooltip__time-item {
	font-size: 12px;
	color: var(--text-muted);
	padding: 2px 0;
}

.gc-task-tooltip .gc-task-tooltip__time-item--overdue {
	color: #d73a49;
	font-weight: 600;
}

.gc-task-tooltip .gc-task-tooltip__file {
	padding-top: 8px;
	border-top: 1px solid var(--divider-color);
	font-size: 11px;
	color: var(--text-muted);
}

.gc-week-view__empty {
	padding: 16px 8px;
	text-align: center;
	color: var(--text-muted);
	font-size: 12px;
	grid-column: 1 / -1;
}

/* ==================== Week View - Gantt Body ==================== */
.gc-week-view__gantt-body {
	flex: 1;
	min-height: 0;
	overflow-y: auto;
	overflow-x: hidden;
	position: relative;
	padding: 4px 0;
}

/* 背景网格线 */
.gc-week-view__gantt-grid-lines {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	display: grid;
	grid-template-columns: repeat(7, 1fr);
	pointer-events: none;
	z-index: 0;
}

.gc-week-view__gantt-grid-line {
	border-right: 1px solid var(--background-modifier-border);
}

.gc-week-view__gantt-grid-line:last-child {
	border-right: none;
}

.gc-week-view__gantt-grid-line--today {
	background-color: var(--gc-today-bg);
}

/* 任务行 */
.gc-week-view__gantt-row {
	position: relative;
	height: 34px;
	margin: 3px 0;
	z-index: 1;
}

/* 任务 Bar */
.gc-week-view__gantt-bar {
	position: absolute;
	top: 2px;
	bottom: 2px;
	display: flex;
	align-items: center;
	gap: 4px;
	padding: 0 8px;
	border-radius: 6px;
	cursor: pointer;
	overflow: hidden;
	white-space: nowrap;
	transition: filter 0.15s ease, box-shadow 0.15s ease;
	font-size: 12px;
	line-height: 1;
	z-index: 1;
}

/* Bar 溢出周范围时移除对应边的圆角和边框 */
.gc-week-view__gantt-bar.gc-week-view__gantt-bar--overflow-left {
	border-top-left-radius: 0 !important;
	border-bottom-left-radius: 0 !important;
	border-left-width: 0 !important;
}

.gc-week-view__gantt-bar.gc-week-view__gantt-bar--overflow-right {
	border-top-right-radius: 0 !important;
	border-bottom-right-radius: 0 !important;
	border-right-width: 0 !important;
}

/* 分组 bar（含展开态）溢出 — 使用高特异性覆盖展开态 border-width */
.gc-week-view__gantt-bar--group.gc-week-view__gantt-bar--expanded.gc-week-view__gantt-bar--overflow-left {
	border-top-left-radius: 0 !important;
	border-bottom-left-radius: 0 !important;
	border-left-width: 0 !important;
}

.gc-week-view__gantt-bar--group.gc-week-view__gantt-bar--expanded.gc-week-view__gantt-bar--overflow-right {
	border-top-right-radius: 0 !important;
	border-bottom-right-radius: 0 !important;
	border-right-width: 0 !important;
}

/* 子任务 mini-bar 溢出 */
.gc-week-view__gantt-bar-child-item.gc-week-view__gantt-bar-child-item--overflow-left {
	border-top-left-radius: 0 !important;
	border-bottom-left-radius: 0 !important;
	border-left-width: 0 !important;
}
.gc-week-view__gantt-bar-child-item.gc-week-view__gantt-bar-child-item--overflow-right {
	border-top-right-radius: 0 !important;
	border-bottom-right-radius: 0 !important;
	border-right-width: 0 !important;
}

/* 展开态子容器（有孙任务）溢出 — 高特异性覆盖 expanded 的 border-width */
.gc-week-view__gantt-bar-child-item--group.gc-week-view__gantt-bar-child-item--expanded.gc-week-view__gantt-bar-child-item--overflow-left {
	border-top-left-radius: 0 !important;
	border-bottom-left-radius: 0 !important;
	border-left-width: 0 !important;
}
.gc-week-view__gantt-bar-child-item--group.gc-week-view__gantt-bar-child-item--expanded.gc-week-view__gantt-bar-child-item--overflow-right {
	border-top-right-radius: 0 !important;
	border-bottom-right-radius: 0 !important;
	border-right-width: 0 !important;
}

/* 孙任务 mini-bar 溢出 */
.gc-week-view__gantt-bar-grandchild-item.gc-week-view__gantt-bar-grandchild-item--overflow-left {
	border-top-left-radius: 0 !important;
	border-bottom-left-radius: 0 !important;
	border-left-width: 0 !important;
}
.gc-week-view__gantt-bar-grandchild-item.gc-week-view__gantt-bar-grandchild-item--overflow-right {
	border-top-right-radius: 0 !important;
	border-bottom-right-radius: 0 !important;
	border-right-width: 0 !important;
}

.gc-week-view__gantt-bar:hover {
	filter: brightness(1.08);
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
	z-index: 2;
}

/* (v4: 移除了旧的 type+priority 组合规则，统一使用纯优先级色) */

/* 已完成甘特条 */
.gc-week-view__gantt-bar--completed {
	background-color: rgba(82, 196, 26, 0.15);
	border: 1px solid rgba(82, 196, 26, 0.35);
	color: var(--text-muted);
	opacity: 0.7;
}

/* ===== NEW: 纯优先级色的 bar 样式（覆盖旧的 type+priority 组合） ===== */
/* 独立的优先级 bar（不带类型修饰时生效） */
.gc-week-view__gantt-bar--priority-high:not(.gc-week-view__gantt-bar--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-high) 20%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-high) 55%, transparent);
	color: var(--text-normal);
}
.gc-week-view__gantt-bar--priority-normal:not(.gc-week-view__gantt-bar--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-normal) 14%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-normal) 35%, transparent);
	color: var(--text-normal);
}
.gc-week-view__gantt-bar--priority-low:not(.gc-week-view__gantt-bar--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-low) 10%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-low) 25%, transparent);
	color: var(--text-muted);
}

/* 提醒类型：斜体标题（不再用虚线边框） */
.gc-week-view__gantt-bar--reminder .gc-week-view__gantt-bar-label {
	font-style: italic;
}

/* 已完成 bar 中的标题：删除线 */
.gc-week-view__gantt-bar--completed .gc-week-view__gantt-bar-label {
	text-decoration: line-through;
}

/* Bar 内容 */
.gc-week-view__gantt-bar-label {
	overflow: hidden;
	text-overflow: ellipsis;
	flex: 1;
}

.gc-week-view__gantt-bar-icon {
	flex-shrink: 0;
	font-size: 12px;
}

/* (Day View Sub-Components removed) */

/* (Legacy priority badge / type+priority / detail / time-badge / file / warning rules removed in v2 cleanup) */

/* Heatmap palette setting (tiled single-select) */
.heatmap-palette-setting {
	display: flex;
	flex-direction: column;
	gap: 8px;
	padding: 12px 0;
	border-bottom: 1px solid var(--background-modifier-border);
}

.heatmap-palette-label {
	padding: 0 10px;
}

.heatmap-palette-name {
	font-weight: 600;
	color: var(--text-normal);
	margin-bottom: 4px;
}

.heatmap-palette-desc {
	font-size: 12px;
	color: var(--text-muted);
}

.heatmap-palette-list {
	display: grid;
	grid-template-columns: repeat(4, 1fr);
	gap: 12px;
	padding: 8px 10px;
}

.heatmap-palette-option {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 8px 10px;
	border: 2px solid transparent;
	border-radius: 8px;
	cursor: pointer;
	transition: all 0.2s ease;
	background: var(--background-secondary);
}

.heatmap-palette-option:hover {
	transform: translateY(-1px);
	box-shadow: 0 2px 8px rgba(0,0,0,0.12);
}

.heatmap-palette-option.selected {
	border-color: var(--interactive-accent);
}

.heatmap-palette-bars {
	display: grid;
	grid-auto-flow: column;
	grid-auto-columns: 14px;
	gap: 3px;
}

.heatmap-palette-bar {
	width: 14px;
	height: 14px;
	border-radius: 2px;
	background-color: var(--background-modifier-border);
}

.heatmap-palette-label-text {
	font-size: 12px;
	color: var(--text-muted);
}

/* Festival Color Settings */
.festival-color-settings-container {
	display: grid;
	grid-template-columns: repeat(3, 1fr);
	gap: 16px;
	padding: 12px 0;
	margin-bottom: 16px;
}

.festival-color-setting {
	display: flex;
	flex-direction: column;
	gap: 8px;
	padding: 12px;
	background: var(--background-secondary);
	border-radius: 8px;
}

.festival-color-label {
	padding: 0 10px;
}

.festival-color-name {
	font-weight: 600;
	color: var(--text-normal);
	margin-bottom: 4px;
}

.festival-color-desc {
	font-size: 12px;
	color: var(--text-muted);
}

.festival-color-picker {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 8px 10px;
	flex-wrap: wrap;
}

.festival-color-input {
	display: none;
}

.festival-color-swatch {
	width: 14px;
	height: 14px;
	border-radius: 2px;
	cursor: pointer;
	transition: all 0.2s ease;
	flex-shrink: 0;
}

.festival-color-swatch:hover {
	transform: scale(1.1);
	box-shadow: 0 1px 4px rgba(0, 0, 0, 0.15);
}

/* Task Status Setting */
.task-status-setting {
	margin-top: 12px;
}

.task-status-label {
	padding: 0 10px;
	margin-bottom: 12px;
}

.task-status-name {
	font-weight: 600;
	color: var(--text-normal);
	margin-bottom: 4px;
}

.task-status-desc {
	font-size: 12px;
	color: var(--text-muted);
}

/* ========================================
   LAYER 7: Themes (主题层)
   Visual States & Modifiers
   ======================================== */

/* 7.1 Task Status States (高特指性) */


/* Week View — 已完成任务降低不透明度 */
.gc-week-view__tasks-grid .gc-task-card--week.gc-task-card--completed {
	opacity: 0.6;
}

/* 7.2 Interactive States (hover, active) */
.gc-task-card--day:hover {
	transform: translateX(4px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.gc-task-card--week:hover {
	transform: translateX(2px);
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.gc-task-card--month:hover {
	transform: translateX(1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* (Legacy task hover with translateX removed in v2 cleanup) */

/* BEM类名: gc-month-view__day-cell */
.gc-month-view__day-cell:hover {
	background-color: var(--background-modifier-hover);
	box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* 7.4 Festival Themes */
/* Month view specific festival styles */
/* BEM类名: gc-month-view__lunar-text--festival */
.gc-month-view__lunar-text--festival {
	font-weight: 600;
}

/* BEM类名: gc-month-view__lunar-text--festival-solar */
.gc-month-view__lunar-text--festival-solar {
	color: var(--festival-solar-color);
}

/* BEM类名: gc-month-view__lunar-text--festival-lunar */
.gc-month-view__lunar-text--festival-lunar {
	color: var(--festival-lunar-color);
}

/* BEM类名: gc-month-view__lunar-text--festival-solar-term */
.gc-month-view__lunar-text--festival-solar-term {
	color: var(--festival-solar-term-color);
}

/* 7.5 Special States */
/* BEM类名: gc-month-view__day-cell--outside-month */
.gc-month-view__day-cell--outside-month {
	background-color: var(--background-secondary);
	opacity: 0.5;
}

.gc-month-view__day-cell--outside-month .gc-month-view__day-number {
	color: var(--text-faint);
}

/* Today state */
/* 月视图今天样式 */
/* BEM类名: gc-month-view__day-cell--today */
.gc-month-view__day-cell--today {
	background-color: var(--gc-today-bg);
}

.gc-month-view__day-cell--today .gc-month-view__day-number {
	color: #ff6b6b;
	font-weight: 700;
}

.gc-month-view__day-cell--today .gc-month-view__lunar-text {
	color: rgba(255, 107, 107, 0.8);
}

.gc-week-view__header-cell--today {
	background-color: var(--gc-today-bg);
}

.gc-week-view__header-cell--today .gc-week-view__day-number {
	color: #ff6b6b;
}

.gc-week-view__tasks-column--today {
	background-color: rgba(255, 107, 107, 0.03);
}

/* 7.6 Text Decoration (已完成任务) */
/* 排除自定义状态的已完成任务，使用自定义文字颜色 */
.gc-week-view__tasks-grid .gc-task-card--week.gc-task-card--completed:not(.task-with-status) .gc-task-card__text {
	text-decoration: line-through;
	color: var(--text-muted);
}

/* ========================================
   LAYER 8: Trumps (覆盖层)
   Utilities & Overrides
   ======================================== */

/* No utility classes currently defined */
/* Future utility classes can be added here as needed */

.gc-tag--popup {
	display: inline-block;
	padding: 2px 6px;
	margin-right: 4px;
	margin-bottom: 4px;
	background-color: var(--tag-background);
	color: var(--tag-color);
	border-radius: 4px;
	font-size: 11px;
}

/* ========================================
   创建任务弹窗样式
   ======================================== */

/* 创建任务弹窗 */
.gc-create-task-modal {
	max-width: 600px;
}

.gc-create-task-modal__form {
	display: flex;
	flex-direction: column;
	gap: 16px;
}

.gc-create-task-modal__field {
	display: flex;
	flex-direction: column;
	gap: 6px;
}

.gc-create-task-modal__label {
	font-weight: 500;
	font-size: var(--font-ui-small);
	color: var(--text-muted);
}

.gc-create-task-modal__input,
.gc-create-task-modal__textarea {
	width: 100%;
	padding: 8px 12px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	background: var(--background-primary);
	color: var(--text-normal);
	font-family: var(--font-interface);
	font-size: var(--font-ui-small);
}

.gc-create-task-modal__input:focus,
.gc-create-task-modal__textarea:focus {
	border-color: var(--interactive-accent);
	outline: none;
}

.gc-create-task-modal__textarea {
	min-height: 80px;
	resize: vertical;
	line-height: 1.5;
}

.gc-create-task-modal__tags-container {
	display: flex;
	flex-direction: column;
	gap: 8px;
}

.gc-create-task-modal__tag-item {
	display: inline-block;
	padding: 4px 10px;
	margin: 0;
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	background: var(--background-secondary);
	color: var(--text-normal);
	font-size: var(--font-ui-smaller);
	cursor: pointer;
	transition: all 0.2s ease;
	user-select: none;
}

.gc-create-task-modal__tag-item:hover {
	background: var(--background-modifier-hover);
}

.gc-create-task-modal__tag-item--selected {
	background: var(--interactive-accent);
	color: var(--text-on-accent);
	border-color: var(--interactive-accent);
}

.gc-create-task-modal__tag-input {
	flex: 1;
}

.gc-create-task-modal__buttons {
	display: flex;
	justify-content: flex-end;
	gap: 12px;
	margin-top: 8px;
	padding-top: 16px;
	border-top: 1px solid var(--background-modifier-border);
}

/* 创建任务按钮 */
.gc-create-task-btn {
	font-size: 1.2em;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	transition: transform 0.1s ease;
}

.gc-create-task-btn:active {
	transform: scale(0.95);
}

.gc-create-task-btn--toolbar {
	padding: 4px 8px;
	min-width: 32px;
}

/* (Legacy type-reminder / type-todo / overdue / compact bell-icon rules removed in v2 cleanup) */

/* === Tooltip 类型徽章 === */
.gc-task-tooltip__type-badge {
	display: inline-block;
	padding: 1px 6px;
	border-radius: 4px;
	font-size: 0.8em;
	font-weight: 500;
	margin-right: 4px;
	vertical-align: middle;
}

.gc-task-tooltip__type-badge--todo {
	background-color: rgba(var(--color-accent-rgb, 124, 77, 255), 0.12);
	color: var(--interactive-accent);
}

.gc-task-tooltip__type-badge--reminder {
	background-color: rgba(var(--color-blue-rgb, 68, 138, 255), 0.12);
	color: var(--color-blue);
}

/* === 甘特图类型样式 === */
/* 提醒在甘特图中显示为圆点标记 */
.task-type-reminder .bar {
	rx: 8;
	ry: 8;
}

.task-type-reminder .bar-label {
	font-style: italic;
}

/* 待办在甘特图中显示为标准时间段条 */
.task-type-todo .bar {
	rx: 2;
	ry: 2;
}

/* === 优先级样式（三级系统）=== */
.priority-high {
	color: var(--color-red);
	font-weight: 600;
}

.priority-normal {
	color: var(--text-muted);
}

.priority-low {
	color: var(--color-blue);
}

/* ============================================================
   子任务管理区域 — EditTaskModal
   ============================================================ */

.gc-edit-task-modal__subtask-section {
	margin-top: 16px;
	padding-top: 16px;
	border-top: 1px solid var(--background-modifier-border);
}

.gc-edit-task-modal__subtask-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-bottom: 8px;
}

.gc-edit-task-modal__subtask-progress {
	font-size: var(--font-ui-small);
	color: var(--text-muted);
	font-weight: 500;
}

.gc-edit-task-modal__subtask-list {
	display: flex;
	flex-direction: column;
	gap: 4px;
	margin-bottom: 8px;
	max-height: 200px;
	overflow-y: auto;
}

.gc-edit-task-modal__subtask-item {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 6px 8px;
	border-radius: 4px;
	background: var(--background-secondary);
	border: 1px solid var(--background-modifier-border);
	transition: background 0.15s;
}

.gc-edit-task-modal__subtask-item:hover {
	background: var(--background-modifier-hover);
}

.gc-edit-task-modal__subtask-item-checkbox {
	flex-shrink: 0;
	cursor: pointer;
}

.gc-edit-task-modal__subtask-item-text {
	flex: 1;
	font-size: var(--font-ui-small);
	color: var(--text-normal);
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

.gc-edit-task-modal__subtask-item-due {
	flex-shrink: 0;
	font-size: var(--font-ui-smaller);
	color: var(--text-muted);
}

.gc-edit-task-modal__subtask-item-actions {
	display: flex;
	gap: 2px;
	flex-shrink: 0;
}

.gc-edit-task-modal__subtask-item-actions button {
	padding: 2px 4px;
	border: none;
	background: transparent;
	cursor: pointer;
	font-size: 12px;
	opacity: 0.5;
	transition: opacity 0.15s;
}

.gc-edit-task-modal__subtask-item-actions button:hover {
	opacity: 1;
}

.gc-edit-task-modal__subtask-add-row {
	display: flex;
	gap: 6px;
	align-items: center;
}

.gc-edit-task-modal__subtask-add-input {
	flex: 1;
	padding: 6px 10px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	background: var(--background-secondary);
	color: var(--text-normal);
	font-size: var(--font-ui-small);
}

.gc-edit-task-modal__subtask-add-input:focus {
	outline: 2px solid var(--interactive-accent);
	border-color: var(--interactive-accent);
}

/* ============================================================
   任务视图 — 树形展示
   ============================================================ */

/* ============================================================
   Task View — 任务树结构 & 连接线
   ============================================================ */

.gc-task-tree-item {
	position: relative;
	display: flex;
	align-items: center;
	gap: 0;
}

.gc-task-tree-item .gc-task-card {
	flex: 1;
	min-width: 0;
}

.gc-task-tree-toggle {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	width: 20px;
	height: 20px;
	cursor: pointer;
	font-size: 9px;
	color: var(--text-muted);
	flex-shrink: 0;
	border-radius: 3px;
	transition: background 0.15s, color 0.15s;
	user-select: none;
	margin-right: 2px;
}

.gc-task-tree-toggle:hover {
	background: var(--background-modifier-hover);
	color: var(--text-normal);
}

/* 无子任务时的占位（与 toggle 等宽，确保对齐） */
.gc-task-tree-spacer {
	display: inline-block;
	width: 20px;
	flex-shrink: 0;
	margin-right: 2px;
}

/* 子任务容器 — 左侧连接线 (GitHub Issues 风格) */
.gc-task-tree-children {
	margin-left: 10px;
	padding-left: 16px;
	border-left: 1.5px solid var(--gc-line-color);
	display: flex;
	flex-direction: column;
	gap: 2px;
}

/* ============================================================
   周视图 — 子任务分组 bar
   ============================================================ */

/* 分组行：自动高度 */
.gc-week-view__gantt-row--group {
	height: auto;
	min-height: 34px;
}

/* 分组 bar 基础：脱离 absolute 布局，改为 relative 使行高自适应 */
.gc-week-view__gantt-bar--group {
	position: relative;
	top: auto;
	bottom: auto;
	left: auto;
	margin: 2px 0;
	flex-direction: column;
	align-items: stretch;
	padding: 0;
	min-height: 30px;
	cursor: default;
	transition: background-color 0.2s, border-color 0.2s, opacity 0.2s;
}

/* 展开态：父 bar 变为轻背景 + 实线边框容器 */
.gc-week-view__gantt-bar--group.gc-week-view__gantt-bar--expanded {
	background-color: transparent !important;
	border-width: 1.5px !important;
	border-style: solid !important;
	opacity: 1 !important;
}
/* 展开态 — 按优先级着色（v4: 替代旧的 type-based 规则） */
.gc-week-view__gantt-bar--group.gc-week-view__gantt-bar--expanded.gc-week-view__gantt-bar--priority-high {
	background-color: color-mix(in srgb, var(--gc-priority-high) 5%, transparent) !important;
	border-color: color-mix(in srgb, var(--gc-priority-high) 40%, transparent) !important;
}
.gc-week-view__gantt-bar--group.gc-week-view__gantt-bar--expanded.gc-week-view__gantt-bar--priority-normal {
	background-color: color-mix(in srgb, var(--gc-priority-normal) 5%, transparent) !important;
	border-color: color-mix(in srgb, var(--gc-priority-normal) 40%, transparent) !important;
}
.gc-week-view__gantt-bar--group.gc-week-view__gantt-bar--expanded.gc-week-view__gantt-bar--priority-low {
	background-color: color-mix(in srgb, var(--gc-priority-low) 5%, transparent) !important;
	border-color: color-mix(in srgb, var(--gc-priority-low) 40%, transparent) !important;
}
/* 展开态 completed：淡绿背景 + 绿色边框 */
.gc-week-view__gantt-bar--group.gc-week-view__gantt-bar--expanded.gc-week-view__gantt-bar--completed {
	background-color: color-mix(in srgb, var(--gc-status-completed) 5%, transparent) !important;
	border-color: color-mix(in srgb, var(--gc-status-completed) 40%, transparent) !important;
}

/* bar 头部（父任务信息行） */
.gc-week-view__gantt-bar-header {
	display: flex;
	align-items: center;
	gap: 4px;
	padding: 2px 8px;
	min-height: 30px;
	cursor: pointer;
}

.gc-week-view__gantt-bar-header:hover {
	background-color: rgba(128, 128, 128, 0.06);
	border-radius: 4px;
}

/* v4: 有子条目的甘特条标题显示下划线，表示可展开 */
/* 注意：不可使用 text-underline-offset，会被 overflow: hidden 裁剪 */
.gc-week-view__gantt-bar-label--has-children {
	text-decoration: underline;
	cursor: pointer;
}

/* 子任务列表容器 */
.gc-week-view__gantt-bar-children {
	display: flex;
	flex-direction: column;
	padding: 2px 0;
	gap: 2px;
}

/* ---- 子任务 mini-bar（按日期定位，带颜色） ---- */
.gc-week-view__gantt-bar-child-item {
	display: flex;
	align-items: center;
	gap: 4px;
	padding: 2px 6px 2px 20px;  /* v4: 左侧内边距20px，文字缩进体现层级（bar块不缩进） */
	min-height: 24px;   /* v4: 从26px缩减，降低子任务视觉权重 */
	font-size: 11px;    /* v4: 从12px缩减 */
	cursor: pointer;
	border-radius: 4px;
	overflow: hidden;
	white-space: nowrap;
	text-overflow: ellipsis;
}

.gc-week-view__gantt-bar-child-item:hover {
	filter: brightness(1.1);
	box-shadow: 0 1px 4px rgba(0, 0, 0, 0.12);
}

/* 一级子任务作为容器（有孙任务时） */
.gc-week-view__gantt-bar-child-item--group {
	flex-direction: column;
	align-items: stretch;
	padding: 0;
	cursor: default;
	overflow: visible;
}
/* v4: 展开态子任务 header 保持文字缩进 */
.gc-week-view__gantt-bar-child-item--group > .gc-week-view__gantt-bar-header {
	padding-left: 20px;
	white-space: normal;
	transition: background-color 0.2s, border-color 0.2s;
}

/* 一级子任务展开态：变为淡色容器 */
.gc-week-view__gantt-bar-child-item--group.gc-week-view__gantt-bar-child-item--expanded {
	background-color: transparent !important;
	border-width: 1.5px !important;
	border-style: solid !important;
	opacity: 1 !important;
}
/* 子任务展开态 — 按优先级着色（v4） */
.gc-week-view__gantt-bar-child-item--group.gc-week-view__gantt-bar-child-item--expanded.gc-week-view__gantt-bar-child-item--priority-high {
	background-color: color-mix(in srgb, var(--gc-priority-high) 5%, transparent) !important;
	border-color: color-mix(in srgb, var(--gc-priority-high) 40%, transparent) !important;
}
.gc-week-view__gantt-bar-child-item--group.gc-week-view__gantt-bar-child-item--expanded.gc-week-view__gantt-bar-child-item--priority-normal {
	background-color: color-mix(in srgb, var(--gc-priority-normal) 5%, transparent) !important;
	border-color: color-mix(in srgb, var(--gc-priority-normal) 40%, transparent) !important;
}
.gc-week-view__gantt-bar-child-item--group.gc-week-view__gantt-bar-child-item--expanded.gc-week-view__gantt-bar-child-item--priority-low {
	background-color: color-mix(in srgb, var(--gc-priority-low) 5%, transparent) !important;
	border-color: color-mix(in srgb, var(--gc-priority-low) 40%, transparent) !important;
}
.gc-week-view__gantt-bar-child-item--group.gc-week-view__gantt-bar-child-item--expanded.gc-week-view__gantt-bar-child-item--completed {
	background-color: color-mix(in srgb, var(--gc-status-completed) 5%, transparent) !important;
	border-color: color-mix(in srgb, var(--gc-status-completed) 40%, transparent) !important;
}

/* 子 bar 颜色（v4: 纯优先级色，通过 CSS 变量） */
.gc-week-view__gantt-bar-child-item--priority-high:not(.gc-week-view__gantt-bar-child-item--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-high) 20%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-high) 50%, transparent);
	color: var(--text-normal);
}
.gc-week-view__gantt-bar-child-item--priority-normal:not(.gc-week-view__gantt-bar-child-item--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-normal) 14%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-normal) 35%, transparent);
	color: var(--text-normal);
}
.gc-week-view__gantt-bar-child-item--priority-low:not(.gc-week-view__gantt-bar-child-item--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-low) 10%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-low) 25%, transparent);
	color: var(--text-muted);
}
.gc-week-view__gantt-bar-child-item--completed {
	background-color: color-mix(in srgb, var(--gc-status-completed) 15%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-status-completed) 35%, transparent);
	color: var(--text-muted);
	opacity: 0.7;
}
.gc-week-view__gantt-bar-child-item--completed .gc-week-view__gantt-bar-label {
	text-decoration: line-through;
}

/* ---- 孙任务 mini-bar ---- */
.gc-week-view__gantt-bar-grandchild-item {
	display: flex;
	align-items: center;
	gap: 4px;
	padding: 1px 5px 1px 34px;  /* v4: 左侧内边距34px（比子任务更深），文字缩进体现层级 */
	min-height: 20px;   /* v4: 从22px缩减，进一步降低孙任务视觉权重 */
	font-size: 10px;    /* v4: 从11px缩减 */
	cursor: pointer;
	border-radius: 3px;
	overflow: hidden;
	white-space: nowrap;
	text-overflow: ellipsis;
}

.gc-week-view__gantt-bar-grandchild-item:hover {
	filter: brightness(1.1);
	box-shadow: 0 1px 4px rgba(0, 0, 0, 0.12);
}

/* 孙 bar 颜色（v4: 纯优先级色，通过 CSS 变量，比子 bar 更浅） */
.gc-week-view__gantt-bar-grandchild-item--priority-high:not(.gc-week-view__gantt-bar-grandchild-item--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-high) 15%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-high) 40%, transparent);
	color: var(--text-normal);
}
.gc-week-view__gantt-bar-grandchild-item--priority-normal:not(.gc-week-view__gantt-bar-grandchild-item--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-normal) 10%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-normal) 28%, transparent);
	color: var(--text-normal);
}
.gc-week-view__gantt-bar-grandchild-item--priority-low:not(.gc-week-view__gantt-bar-grandchild-item--completed) {
	background-color: color-mix(in srgb, var(--gc-priority-low) 7%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-priority-low) 18%, transparent);
	color: var(--text-muted);
}
.gc-week-view__gantt-bar-grandchild-item--completed {
	background-color: color-mix(in srgb, var(--gc-status-completed) 12%, transparent);
	border: 1px solid color-mix(in srgb, var(--gc-status-completed) 30%, transparent);
	color: var(--text-muted);
	opacity: 0.7;
}
.gc-week-view__gantt-bar-grandchild-item--completed .gc-week-view__gantt-bar-label {
	text-decoration: line-through;
}

/* 折叠三角 */
.gc-week-view__gantt-bar-toggle {
	flex-shrink: 0;
	cursor: pointer;
	font-size: 10px;
	width: 14px;
	opacity: 0.6;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	transition: opacity 0.15s;
	user-select: none;
}

.gc-week-view__gantt-bar-toggle:hover {
	opacity: 1;
}

/* 进度文本 */
.gc-week-view__gantt-bar-progress {
	flex-shrink: 0;
	font-size: 10px;
	opacity: 0.7;
	margin-left: auto;
	padding-left: 4px;
}

/* (Legacy month subtask rules removed in v2 cleanup) */

/* (Legacy progress marker rule removed — see line ~1623 for active rule) */
